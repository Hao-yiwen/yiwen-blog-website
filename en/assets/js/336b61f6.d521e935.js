"use strict";(globalThis.webpackChunkyiwen_blog_website=globalThis.webpackChunkyiwen_blog_website||[]).push([[6870],{6303(s,e,a){a.r(e),a.d(e,{assets:()=>r,contentTitle:()=>t,default:()=>d,frontMatter:()=>c,metadata:()=>l,toc:()=>m});const l=JSON.parse('{"id":"ai/optimization/learning-rate-schedulers","title":"\u5e38\u7528\u5b66\u4e60\u7387\u8c03\u5ea6\u5668\u7b80\u4ecb","description":"0. \u4e3a\u5565\u9700\u8981\u5b66\u4e60\u7387\u8c03\u5ea6\u5668?","source":"@site/docs/ai/optimization/learning-rate-schedulers.md","sourceDirName":"ai/optimization","slug":"/ai/optimization/learning-rate-schedulers","permalink":"/yiwen-blog-website/en/docs/ai/optimization/learning-rate-schedulers","draft":false,"unlisted":false,"editUrl":"https://github.com/Hao-yiwen/yiwen-blog-website/tree/master/docs/ai/optimization/learning-rate-schedulers.md","tags":[],"version":"current","lastUpdatedAt":1763424000000,"frontMatter":{"title":"\u5e38\u7528\u5b66\u4e60\u7387\u8c03\u5ea6\u5668\u7b80\u4ecb","sidebar_label":"\u5b66\u4e60\u7387\u8c03\u5ea6\u5668","date":"2025-11-18T00:00:00.000Z","last_update":{"date":"2025-11-18T00:00:00.000Z"}},"sidebar":"aiSidebar","previous":{"title":"Adam vs SGD \u4f18\u5316\u5668","permalink":"/yiwen-blog-website/en/docs/ai/optimization/adam-vs-sgd"},"next":{"title":"Momentum \u52a8\u91cf\u7b97\u6cd5\u8be6\u89e3","permalink":"/yiwen-blog-website/en/docs/ai/optimization/momentum-explained"}}');var n=a(74848),i=a(28453);const c={title:"\u5e38\u7528\u5b66\u4e60\u7387\u8c03\u5ea6\u5668\u7b80\u4ecb",sidebar_label:"\u5b66\u4e60\u7387\u8c03\u5ea6\u5668",date:new Date("2025-11-18T00:00:00.000Z"),last_update:{date:new Date("2025-11-18T00:00:00.000Z")}},t="\u5e38\u7528\u5b66\u4e60\u7387\u8c03\u5ea6\u5668\u7b80\u4ecb",r={},m=[{value:"0. \u4e3a\u5565\u9700\u8981\u5b66\u4e60\u7387\u8c03\u5ea6\u5668?",id:"0-\u4e3a\u5565\u9700\u8981\u5b66\u4e60\u7387\u8c03\u5ea6\u5668",level:2},{value:"1. \u56fa\u5b9a\u5b66\u4e60\u7387 / \u624b\u52a8\u8c03 lr",id:"1-\u56fa\u5b9a\u5b66\u4e60\u7387--\u624b\u52a8\u8c03-lr",level:2},{value:"\u601d\u60f3",id:"\u601d\u60f3",level:3},{value:"\u4f7f\u7528\u573a\u666f",id:"\u4f7f\u7528\u573a\u666f",level:3},{value:"PyTorch \u793a\u4f8b",id:"pytorch-\u793a\u4f8b",level:3},{value:"2. StepLR / MultiStepLR \u2014\u2014 \u9636\u68af\u4e0b\u964d",id:"2-steplr--multisteplr--\u9636\u68af\u4e0b\u964d",level:2},{value:"\u601d\u60f3",id:"\u601d\u60f3-1",level:3},{value:"\u516c\u5f0f\uff08StepLR\uff09",id:"\u516c\u5f0fsteplr",level:3},{value:"PyTorch \u793a\u4f8b",id:"pytorch-\u793a\u4f8b-1",level:3},{value:"\u7279\u70b9",id:"\u7279\u70b9",level:3},{value:"3. ExponentialLR \u2014\u2014 \u6307\u6570\u8870\u51cf",id:"3-exponentiallr--\u6307\u6570\u8870\u51cf",level:2},{value:"\u601d\u60f3",id:"\u601d\u60f3-2",level:3},{value:"PyTorch",id:"pytorch",level:3},{value:"\u7279\u70b9",id:"\u7279\u70b9-1",level:3},{value:"4. CosineAnnealingLR \u2014\u2014 \u4f59\u5f26\u9000\u706b\uff08\u534a\u4e2a\u4f59\u5f26\u6ce2\uff09",id:"4-cosineannealinglr--\u4f59\u5f26\u9000\u706b\u534a\u4e2a\u4f59\u5f26\u6ce2",level:2},{value:"\u601d\u60f3",id:"\u601d\u60f3-3",level:3},{value:"PyTorch",id:"pytorch-1",level:3},{value:"\u7279\u70b9",id:"\u7279\u70b9-2",level:3},{value:"5. CosineAnnealingWarmRestarts \u2014\u2014 \u4f59\u5f26 + \u5468\u671f\u91cd\u542f",id:"5-cosineannealingwarmrestarts--\u4f59\u5f26--\u5468\u671f\u91cd\u542f",level:2},{value:"\u601d\u60f3",id:"\u601d\u60f3-4",level:3},{value:"PyTorch",id:"pytorch-2",level:3},{value:"\u7279\u70b9",id:"\u7279\u70b9-3",level:3},{value:"6. ReduceLROnPlateau \u2014\u2014 \u6307\u6807\u4e0d\u6da8\u5c31\u780d lr",id:"6-reducelronplateau--\u6307\u6807\u4e0d\u6da8\u5c31\u780d-lr",level:2},{value:"\u601d\u60f3",id:"\u601d\u60f3-5",level:3},{value:"PyTorch",id:"pytorch-3",level:3},{value:"\u7279\u70b9",id:"\u7279\u70b9-4",level:3},{value:"7. OneCycleLR \u2014\u2014 \u4e00\u6b21 cycle\uff0c\u524d\u5347\u540e\u964d",id:"7-onecyclelr--\u4e00\u6b21-cycle\u524d\u5347\u540e\u964d",level:2},{value:"\u601d\u60f3",id:"\u601d\u60f3-6",level:3},{value:"PyTorch \u7b80\u5316\u4f8b\u5b50",id:"pytorch-\u7b80\u5316\u4f8b\u5b50",level:3},{value:"8. Warmup + \u4e3b\u8c03\u5ea6\u5668\uff08\u975e\u5e38\u5e38\u89c1\uff09",id:"8-warmup--\u4e3b\u8c03\u5ea6\u5668\u975e\u5e38\u5e38\u89c1",level:2},{value:"\u601d\u60f3",id:"\u601d\u60f3-7",level:3},{value:"9. \u5982\u4f55\u9009?",id:"9-\u5982\u4f55\u9009",level:2},{value:"10. \u4e00\u4e2a\u5178\u578b PyTorch \u6a21\u677f",id:"10-\u4e00\u4e2a\u5178\u578b-pytorch-\u6a21\u677f",level:2}];function h(s){const e={annotation:"annotation",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",msup:"msup",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,i.R)(),...s.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.header,{children:(0,n.jsx)(e.h1,{id:"\u5e38\u7528\u5b66\u4e60\u7387\u8c03\u5ea6\u5668\u7b80\u4ecb",children:"\u5e38\u7528\u5b66\u4e60\u7387\u8c03\u5ea6\u5668\u7b80\u4ecb"})}),"\n",(0,n.jsx)(e.h2,{id:"0-\u4e3a\u5565\u9700\u8981\u5b66\u4e60\u7387\u8c03\u5ea6\u5668",children:"0. \u4e3a\u5565\u9700\u8981\u5b66\u4e60\u7387\u8c03\u5ea6\u5668?"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"\u5b66\u4e60\u7387\uff08lr\uff09\u592a\u5927\uff1a\u8bad\u7ec3\u6296\u52a8\u3001\u53d1\u6563\uff1b"}),"\n",(0,n.jsx)(e.li,{children:"\u5b66\u4e60\u7387\u592a\u5c0f\uff1a\u6536\u655b\u5f88\u6162\u3001\u5bb9\u6613\u5361\u5728\u6b21\u4f18\u70b9\u3002"}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.strong,{children:"\u7ecf\u9a8c\uff1a\u8bad\u7ec3\u65e9\u671f lr \u5927\u4e00\u70b9\u591a\u63a2\u7d22\uff0c\u540e\u671f lr \u5c0f\u4e00\u70b9\u7ec6\u8c03\u3002"})}),"\n"]}),"\n",(0,n.jsx)(e.p,{children:"\u5b66\u4e60\u7387\u8c03\u5ea6\u5668\uff08learning rate scheduler\uff09\u5c31\u662f\uff1a"}),"\n",(0,n.jsxs)(e.blockquote,{children:["\n",(0,n.jsxs)(e.p,{children:["\u5728\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\uff0c\u6309\u7167\u67d0\u79cd\u7b56\u7565\u81ea\u52a8\u8c03\u6574 optimizer \u91cc\u7684 ",(0,n.jsx)(e.code,{children:"lr"}),"\u3002"]}),"\n"]}),"\n",(0,n.jsxs)(e.p,{children:["\u5728 PyTorch \u4e2d\uff0c\u5b83\u4eec\u90fd\u5728\uff1a",(0,n.jsx)(e.code,{children:"torch.optim.lr_scheduler"}),"\u3002"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsx)(e.h2,{id:"1-\u56fa\u5b9a\u5b66\u4e60\u7387--\u624b\u52a8\u8c03-lr",children:"1. \u56fa\u5b9a\u5b66\u4e60\u7387 / \u624b\u52a8\u8c03 lr"}),"\n",(0,n.jsx)(e.h3,{id:"\u601d\u60f3",children:"\u601d\u60f3"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["\u8bad\u7ec3\u5168\u7a0b ",(0,n.jsx)(e.code,{children:"lr"})," \u4e0d\u53d8\uff0c\u6216\u8005\u4f60\u81ea\u5df1\u770b loss \u66f2\u7ebf\u3001\u624b\u52a8\u6539 lr\u3002"]}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:"\u4f7f\u7528\u573a\u666f",children:"\u4f7f\u7528\u573a\u666f"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"\u5c0f\u6a21\u578b\u3001\u5c0f\u6570\u636e\u96c6\u3001debug \u9636\u6bb5\uff1b"}),"\n",(0,n.jsx)(e.li,{children:"\u6216\u8005\u4f60\u61d2\u5f97\u7ba1 / \u60f3\u5148\u7c97\u8dd1\u4e00\u7248\u3002"}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:"pytorch-\u793a\u4f8b",children:"PyTorch \u793a\u4f8b"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"optimizer = torch.optim.SGD(model.parameters(), lr=0.1)\n# \u4e0d\u7528 scheduler\n"})}),"\n",(0,n.jsx)(e.p,{children:"\u4f18\u70b9\uff1a\u7b80\u5355\u7c97\u66b4\u3002\n\u7f3a\u70b9\uff1a\u540e\u671f\u4e0d\u6536\u7f29 lr\uff0c\u6548\u679c\u5f80\u5f80\u4e0d\u5982\u9000\u706b\u7b56\u7565\u3002"}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsx)(e.h2,{id:"2-steplr--multisteplr--\u9636\u68af\u4e0b\u964d",children:"2. StepLR / MultiStepLR \u2014\u2014 \u9636\u68af\u4e0b\u964d"}),"\n",(0,n.jsx)(e.h3,{id:"\u601d\u60f3-1",children:"\u601d\u60f3"}),"\n",(0,n.jsx)(e.p,{children:"\u6309\u300c\u697c\u68af\u5f62\u300d\u4e0b\u964d lr\uff1a"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"StepLR"}),"\uff1a\u6bcf\u9694 ",(0,n.jsx)(e.code,{children:"step_size"})," \u4e2a epoch\uff0c\u628a lr \u4e58\u4ee5 ",(0,n.jsx)(e.code,{children:"gamma"}),"\u3002"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"MultiStepLR"}),"\uff1a\u5728\u6307\u5b9a\u7684\u82e5\u5e72 epoch\uff08milestones\uff09\u65f6\uff0c\u628a lr \u4e58\u4ee5 ",(0,n.jsx)(e.code,{children:"gamma"}),"\u3002"]}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:"\u516c\u5f0fsteplr",children:"\u516c\u5f0f\uff08StepLR\uff09"}),"\n",(0,n.jsx)(e.span,{className:"katex-error",title:"ParseError: KaTeX parse error: Expected 'EOF', got '_' at position 54: \u2026c{t}{\\text{step_\u0332size}} \\rfloor}",style:{color:"#cc0000"},children:"lr_t = lr_0 \\cdot \\gamma^{\\lfloor \\frac{t}{\\text{step_size}} \\rfloor}"}),"\n",(0,n.jsx)(e.h3,{id:"pytorch-\u793a\u4f8b-1",children:"PyTorch \u793a\u4f8b"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"# \u6bcf 30 \u4e2a epoch\uff0clr *= 0.1\nscheduler = torch.optim.lr_scheduler.StepLR(\n    optimizer,\n    step_size=30,\n    gamma=0.1,\n)\n\n# \u6216\u8005\u591a\u70b9\u9636\u68af\u4e0b\u964d\nscheduler = torch.optim.lr_scheduler.MultiStepLR(\n    optimizer,\n    milestones=[30, 60, 90],\n    gamma=0.1,\n)\n"})}),"\n",(0,n.jsx)(e.h3,{id:"\u7279\u70b9",children:"\u7279\u70b9"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"\u4f18\u70b9\uff1a\u7ecf\u5178\u3001\u53ef\u63a7\u3001ImageNet \u4f20\u7edf\u914d\u7f6e\u5f88\u591a\u8fd9\u4e48\u5199\uff1b"}),"\n",(0,n.jsx)(e.li,{children:"\u7f3a\u70b9\uff1alr \u53d8\u5316\u662f\u300c\u77ac\u95f4\u8df3\u53d8\u300d\uff0c\u66f2\u7ebf\u4e0d\u591f\u5e73\u6ed1\u3002"}),"\n"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsx)(e.h2,{id:"3-exponentiallr--\u6307\u6570\u8870\u51cf",children:"3. ExponentialLR \u2014\u2014 \u6307\u6570\u8870\u51cf"}),"\n",(0,n.jsx)(e.h3,{id:"\u601d\u60f3-2",children:"\u601d\u60f3"}),"\n",(0,n.jsxs)(e.p,{children:["\u6bcf\u4e2a step / epoch\uff0c\u90fd\u4e58\u4e00\u4e2a\u56fa\u5b9a\u6bd4\u4f8b ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"\u03b3"}),(0,n.jsx)(e.mo,{children:"<"}),(0,n.jsx)(e.mn,{children:"1"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\gamma < 1"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.7335em",verticalAlign:"-0.1944em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05556em"},children:"\u03b3"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"<"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"1"})]})]})]}),"\u3002"]}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"l"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"r"}),(0,n.jsx)(e.mi,{children:"t"})]}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsx)(e.mi,{children:"l"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"r"}),(0,n.jsx)(e.mn,{children:"0"})]}),(0,n.jsx)(e.mo,{children:"\u22c5"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:"\u03b3"}),(0,n.jsx)(e.mi,{children:"t"})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"lr_t = lr_0 \\cdot \\gamma^t"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.8444em",verticalAlign:"-0.15em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.2806em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0278em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.8444em",verticalAlign:"-0.15em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0278em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:"0"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.038em",verticalAlign:"-0.1944em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05556em"},children:"\u03b3"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsx)(e.span,{className:"vlist-t",children:(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8436em"},children:(0,n.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})})]})})})})})]})]})]})]})}),"\n",(0,n.jsx)(e.h3,{id:"pytorch",children:"PyTorch"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"scheduler = torch.optim.lr_scheduler.ExponentialLR(\n    optimizer,\n    gamma=0.95,  # \u6bcf\u4e2a epoch lr *= 0.95\n)\n"})}),"\n",(0,n.jsx)(e.h3,{id:"\u7279\u70b9-1",children:"\u7279\u70b9"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"\u4f18\u70b9\uff1a\u8fde\u7eed\u5e73\u6ed1\u3001\u5b9e\u73b0\u7b80\u5355\uff1b"}),"\n",(0,n.jsx)(e.li,{children:"\u7f3a\u70b9\uff1a\u524d\u671f\u4e0b\u964d\u8f83\u5feb\uff0c\u540e\u671f\u5c3e\u5df4\u8f83\u957f\uff08lr \u4f1a\u4e00\u76f4\u5f80 0 \u9760\u8fd1\u4f46\u4e0d\u4e3a 0\uff09\u3002"}),"\n"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsx)(e.h2,{id:"4-cosineannealinglr--\u4f59\u5f26\u9000\u706b\u534a\u4e2a\u4f59\u5f26\u6ce2",children:"4. CosineAnnealingLR \u2014\u2014 \u4f59\u5f26\u9000\u706b\uff08\u534a\u4e2a\u4f59\u5f26\u6ce2\uff09"}),"\n",(0,n.jsx)(e.h3,{id:"\u601d\u60f3-3",children:"\u601d\u60f3"}),"\n",(0,n.jsx)(e.p,{children:"\u7528\u4e00\u6761\u300c\u534a\u4e2a\u4f59\u5f26\u6ce2\u300d\u4ece\u9ad8 lr \u5e73\u6ed1\u9000\u5230\u4f4e lr\uff1a"}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"l"}),(0,n.jsx)(e.mi,{children:"r"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{children:"t"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"\u03b7"}),(0,n.jsx)(e.mi,{children:"min"}),(0,n.jsx)(e.mo,{children:"\u2061"})]}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"\u03b7"}),(0,n.jsx)(e.mi,{children:"max"}),(0,n.jsx)(e.mo,{children:"\u2061"})]}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"\u03b7"}),(0,n.jsx)(e.mi,{children:"min"}),(0,n.jsx)(e.mo,{children:"\u2061"})]}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{fence:"false",stretchy:"true",minsize:"1.8em",maxsize:"1.8em",children:"("}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{children:"cos"}),(0,n.jsx)(e.mo,{children:"\u2061"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{children:"\u03c0"}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsx)(e.mi,{children:"t"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mi,{children:"max"}),(0,n.jsx)(e.mo,{children:"\u2061"})]})]}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{fence:"false",stretchy:"true",minsize:"1.8em",maxsize:"1.8em",children:")"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"lr(t) = \\eta_{\\min} + \\frac{1}{2}(\\eta_{\\max} - \\eta_{\\min})\n\\Big(1 + \\cos(\\pi \\frac{t}{T_{\\max}})\\Big)"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.7778em",verticalAlign:"-0.1944em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03b7"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3175em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsxs)(e.span,{className:"mop mtight",children:[(0,n.jsx)(e.span,{className:"mtight",children:"m"}),(0,n.jsx)(e.span,{className:"mtight",children:"i"}),(0,n.jsx)(e.span,{className:"mtight",children:"n"})]})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.0074em",verticalAlign:"-0.686em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord",children:"2"})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord",children:"1"})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03b7"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsxs)(e.span,{className:"mop mtight",children:[(0,n.jsx)(e.span,{className:"mtight",children:"m"}),(0,n.jsx)(e.span,{className:"mtight",children:"a"}),(0,n.jsx)(e.span,{className:"mtight",children:"x"})]})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.8em",verticalAlign:"-0.65em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03b7"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3175em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsxs)(e.span,{className:"mop mtight",children:[(0,n.jsx)(e.span,{className:"mtight",children:"m"}),(0,n.jsx)(e.span,{className:"mtight",children:"i"}),(0,n.jsx)(e.span,{className:"mtight",children:"n"})]})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"delimsizing size2",children:"("})}),(0,n.jsx)(e.span,{className:"mord",children:"1"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.1281em",verticalAlign:"-0.836em"}}),(0,n.jsx)(e.span,{className:"mop",children:"cos"}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c0"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.2921em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsxs)(e.span,{className:"mop mtight",children:[(0,n.jsx)(e.span,{className:"mtight",children:"m"}),(0,n.jsx)(e.span,{className:"mtight",children:"a"}),(0,n.jsx)(e.span,{className:"mtight",children:"x"})]})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord mathnormal",children:"t"})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.836em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"delimsizing size2",children:")"})})]})]})]})}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:"t"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"t"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6151em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"t"})]})})]}),"\uff1a\u8c03\u7528 ",(0,n.jsx)(e.code,{children:"scheduler.step()"})," \u7684\u6b21\u6570\uff08\u901a\u5e38\u662f epoch\uff09"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mi,{children:"max"}),(0,n.jsx)(e.mo,{children:"\u2061"})]})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"T_{\\max}"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsxs)(e.span,{className:"mop mtight",children:[(0,n.jsx)(e.span,{className:"mtight",children:"m"}),(0,n.jsx)(e.span,{className:"mtight",children:"a"}),(0,n.jsx)(e.span,{className:"mtight",children:"x"})]})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]}),"\uff1a\u4ece ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"\u03b7"}),(0,n.jsx)(e.mi,{children:"max"}),(0,n.jsx)(e.mo,{children:"\u2061"})]})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\eta_{\\max}"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03b7"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsxs)(e.span,{className:"mop mtight",children:[(0,n.jsx)(e.span,{className:"mtight",children:"m"}),(0,n.jsx)(e.span,{className:"mtight",children:"a"}),(0,n.jsx)(e.span,{className:"mtight",children:"x"})]})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]})," \u9000\u706b\u5230 ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"\u03b7"}),(0,n.jsx)(e.mi,{children:"min"}),(0,n.jsx)(e.mo,{children:"\u2061"})]})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\eta_{\\min}"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03b7"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3175em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsxs)(e.span,{className:"mop mtight",children:[(0,n.jsx)(e.span,{className:"mtight",children:"m"}),(0,n.jsx)(e.span,{className:"mtight",children:"i"}),(0,n.jsx)(e.span,{className:"mtight",children:"n"})]})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]})," \u7684\u603b\u6b65\u6570"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"\u03b7"}),(0,n.jsx)(e.mi,{children:"max"}),(0,n.jsx)(e.mo,{children:"\u2061"})]})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\eta_{\\max}"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03b7"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsxs)(e.span,{className:"mop mtight",children:[(0,n.jsx)(e.span,{className:"mtight",children:"m"}),(0,n.jsx)(e.span,{className:"mtight",children:"a"}),(0,n.jsx)(e.span,{className:"mtight",children:"x"})]})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]}),"\uff1a\u521d\u59cb lr"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"\u03b7"}),(0,n.jsx)(e.mi,{children:"min"}),(0,n.jsx)(e.mo,{children:"\u2061"})]})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\eta_{\\min}"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03b7"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3175em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsxs)(e.span,{className:"mop mtight",children:[(0,n.jsx)(e.span,{className:"mtight",children:"m"}),(0,n.jsx)(e.span,{className:"mtight",children:"i"}),(0,n.jsx)(e.span,{className:"mtight",children:"n"})]})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]}),"\uff1a\u6700\u5c0f lr"]}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:"pytorch-1",children:"PyTorch"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"scheduler = torch.optim.lr_scheduler.CosineAnnealingLR(\n    optimizer,\n    T_max=num_epochs,  # \u5e38\u89c1\u7528\u6cd5\uff1a= \u603b epoch \u6570\n    eta_min=1e-6\n)\n\nfor epoch in range(num_epochs):\n    train(...)\n    scheduler.step()\n"})}),"\n",(0,n.jsx)(e.h3,{id:"\u7279\u70b9-2",children:"\u7279\u70b9"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"\u5f62\u72b6\uff1a\u4e24\u5934\u5e73\u3001\u4e2d\u95f4\u9661\uff0c\u975e\u5e38\u5e73\u6ed1\uff1b"}),"\n",(0,n.jsxs)(e.li,{children:["\u65e9\u671f\u4fdd\u6301\u8f83\u5927 lr\uff0c\u540e\u671f\u8d34\u8fd1 ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"\u03b7"}),(0,n.jsx)(e.mi,{children:"min"}),(0,n.jsx)(e.mo,{children:"\u2061"})]})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\eta_{\\min}"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03b7"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3175em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsxs)(e.span,{className:"mop mtight",children:[(0,n.jsx)(e.span,{className:"mtight",children:"m"}),(0,n.jsx)(e.span,{className:"mtight",children:"i"}),(0,n.jsx)(e.span,{className:"mtight",children:"n"})]})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]})," \u7cbe\u8c03\uff1b"]}),"\n",(0,n.jsx)(e.li,{children:"\u73b0\u5728\u5404\u79cd CV / NLP \u91cc\u975e\u5e38\u5e38\u89c1\uff0c\u5c24\u5176\u914d\u5408 warmup\u3002"}),"\n"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsx)(e.h2,{id:"5-cosineannealingwarmrestarts--\u4f59\u5f26--\u5468\u671f\u91cd\u542f",children:"5. CosineAnnealingWarmRestarts \u2014\u2014 \u4f59\u5f26 + \u5468\u671f\u91cd\u542f"}),"\n",(0,n.jsx)(e.h3,{id:"\u601d\u60f3-4",children:"\u601d\u60f3"}),"\n",(0,n.jsx)(e.p,{children:"\u5728\u4f59\u5f26\u9000\u706b\u7684\u57fa\u7840\u4e0a\uff0c\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u300c\u91cd\u542f\u300d\u4e00\u6b21 lr\uff1a"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["\u6bcf\u4e2a\u5468\u671f\u5185\uff1a\u4ece ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"\u03b7"}),(0,n.jsx)(e.mi,{children:"max"}),(0,n.jsx)(e.mo,{children:"\u2061"})]})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\eta_{\\max}"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03b7"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsxs)(e.span,{className:"mop mtight",children:[(0,n.jsx)(e.span,{className:"mtight",children:"m"}),(0,n.jsx)(e.span,{className:"mtight",children:"a"}),(0,n.jsx)(e.span,{className:"mtight",children:"x"})]})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]})," \u2192 \u4f59\u5f26\u9000\u706b \u2192 ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"\u03b7"}),(0,n.jsx)(e.mi,{children:"min"}),(0,n.jsx)(e.mo,{children:"\u2061"})]})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\eta_{\\min}"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03b7"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3175em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsxs)(e.span,{className:"mop mtight",children:[(0,n.jsx)(e.span,{className:"mtight",children:"m"}),(0,n.jsx)(e.span,{className:"mtight",children:"i"}),(0,n.jsx)(e.span,{className:"mtight",children:"n"})]})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]})]}),"\n",(0,n.jsxs)(e.li,{children:["\u5468\u671f\u7ed3\u675f\u65f6\uff1alr \u7a81\u7136\u91cd\u7f6e\u4e3a ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"\u03b7"}),(0,n.jsx)(e.mi,{children:"max"}),(0,n.jsx)(e.mo,{children:"\u2061"})]})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\eta_{\\max}"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03b7"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsxs)(e.span,{className:"mop mtight",children:[(0,n.jsx)(e.span,{className:"mtight",children:"m"}),(0,n.jsx)(e.span,{className:"mtight",children:"a"}),(0,n.jsx)(e.span,{className:"mtight",children:"x"})]})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]}),"\uff0c\u518d\u6765\u4e0b\u4e00\u6bb5\u534a\u4e2a\u4f59\u5f26\u6ce2"]}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:"pytorch-2",children:"PyTorch"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"scheduler = torch.optim.lr_scheduler.CosineAnnealingWarmRestarts(\n    optimizer,\n    T_0=10,     # \u7b2c\u4e00\u4e2a\u5468\u671f 10 \u4e2a epoch\n    T_mult=2,   # \u6bcf\u6b21\u5468\u671f\u957f\u5ea6\u4e58 2\uff1a10 -> 20 -> 40 ...\n    eta_min=1e-6\n)\n\nfor epoch in range(num_epochs):\n    train(...)\n    scheduler.step()\n"})}),"\n",(0,n.jsx)(e.h3,{id:"\u7279\u70b9-3",children:"\u7279\u70b9"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"\u6709\u70b9\u50cf\u5468\u671f\u6027\u300c\u518d\u63a2\u7d22\u300d\uff1a\u6bcf\u6b21\u91cd\u542f\u7ed9\u4e00\u4e2a\u5927 lr\uff1b"}),"\n",(0,n.jsx)(e.li,{children:"\u7406\u8bba\u4e0a\u6709\u52a9\u4e8e\u8df3\u51fa\u5c40\u90e8\u6700\u4f18\uff1b"}),"\n",(0,n.jsx)(e.li,{children:"\u66f2\u7ebf\u662f\u597d\u591a\u6bb5\u5e73\u6ed1\u7684\u5c0f\u5c71\u4e18\u3002"}),"\n"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsx)(e.h2,{id:"6-reducelronplateau--\u6307\u6807\u4e0d\u6da8\u5c31\u780d-lr",children:"6. ReduceLROnPlateau \u2014\u2014 \u6307\u6807\u4e0d\u6da8\u5c31\u780d lr"}),"\n",(0,n.jsx)(e.h3,{id:"\u601d\u60f3-5",children:"\u601d\u60f3"}),"\n",(0,n.jsx)(e.p,{children:"\u4e0d\u662f\u6309 epoch \u6216 step \u673a\u68b0\u8c03\u6574\uff0c\u800c\u662f\u770b\u67d0\u4e2a metric\uff08\u6bd4\u5982 val loss / val acc\uff09\uff1a"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["\u5982\u679c\u82e5\u5e72\u4e2a epoch \u5185\u6307\u6807\u6ca1\u6709\u6539\u5584\uff0c\u5c31\u628a lr \u4e58\u4ee5 ",(0,n.jsx)(e.code,{children:"factor"}),"\u3002"]}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:"pytorch-3",children:"PyTorch"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"scheduler = torch.optim.lr_scheduler.ReduceLROnPlateau(\n    optimizer,\n    mode='min',        # \u76d1\u63a7\u7684\u6307\u6807\u662f\u8d8a\u5c0f\u8d8a\u597d\uff08\u5982 val_loss\uff09\n    factor=0.1,        # lr *= 0.1\n    patience=5,        # 5 \u4e2a epoch \u6ca1\u63d0\u5347\u5c31\u780d lr\n    min_lr=1e-6,\n)\n\nfor epoch in range(num_epochs):\n    train(...)\n    val_loss = validate(...)\n    scheduler.step(val_loss)   # \u6ce8\u610f\uff1a\u8fd9\u91cc\u8981\u4f20\u5165 metric\n"})}),"\n",(0,n.jsx)(e.h3,{id:"\u7279\u70b9-4",children:"\u7279\u70b9"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"\u6570\u636e\u9a71\u52a8\uff1a\u6839\u636e\u6a21\u578b\u8868\u73b0\u6765\u51b3\u5b9a\u662f\u5426\u51cf lr\uff1b"}),"\n",(0,n.jsx)(e.li,{children:"\u5e38\u89c1\u4e8e\u4f20\u7edf\u6df1\u5ea6\u5b66\u4e60\u9879\u76ee\u3001Kaggle \u4ee3\u7801\uff1b"}),"\n",(0,n.jsx)(e.li,{children:"\u548c\u5176\u4ed6 scheduler \u53ef\u4ee5\u7ec4\u5408\u4f7f\u7528\uff08\u4f46\u8981\u5c0f\u5fc3\u51b2\u7a81\uff09\u3002"}),"\n"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsx)(e.h2,{id:"7-onecyclelr--\u4e00\u6b21-cycle\u524d\u5347\u540e\u964d",children:"7. OneCycleLR \u2014\u2014 \u4e00\u6b21 cycle\uff0c\u524d\u5347\u540e\u964d"}),"\n",(0,n.jsx)(e.h3,{id:"\u601d\u60f3-6",children:"\u601d\u60f3"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"\u5148\u4ece\u8f83\u5c0f lr \u5347\u5230\u4e00\u4e2a\u8f83\u5927\u7684 lr\uff08\u63a2\u7d22\uff09\uff1b"}),"\n",(0,n.jsxs)(e.li,{children:["\u7136\u540e\u518d\u9000\u706b\u964d\u5230\u975e\u5e38\u5c0f\u7684 lr\uff08\u6536\u655b\uff09\u3002\n\u5e38\u7528\u4e8e ",(0,n.jsx)(e.strong,{children:"\u5927 batch \u8bad\u7ec3 / fast.ai \u98ce\u683c\u8bad\u7ec3"}),"\u3002"]}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:"pytorch-\u7b80\u5316\u4f8b\u5b50",children:"PyTorch \u7b80\u5316\u4f8b\u5b50"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"scheduler = torch.optim.lr_scheduler.OneCycleLR(\n    optimizer,\n    max_lr=0.1,\n    total_steps=num_epochs * steps_per_epoch\n)\n\nfor epoch in range(num_epochs):\n    for batch in train_loader:\n        train_step(...)\n        scheduler.step()   # \u6bcf\u4e2a iteration \u8c03\u4e00\u6b21\n"})}),"\n",(0,n.jsx)(e.p,{children:"\u7279\u70b9\uff1a"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"\u5bf9\u4e8e\u4e00\u4e9b\u4efb\u52a1\uff0c\u6536\u655b\u901f\u5ea6\u5f88\u5feb\uff1b"}),"\n",(0,n.jsx)(e.li,{children:"\u9700\u8981\u4e8b\u5148\u77e5\u9053 total_steps\uff0c\u914d\u7f6e\u7a0d\u5fae\u9ebb\u70e6\u70b9\u3002"}),"\n"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsx)(e.h2,{id:"8-warmup--\u4e3b\u8c03\u5ea6\u5668\u975e\u5e38\u5e38\u89c1",children:"8. Warmup + \u4e3b\u8c03\u5ea6\u5668\uff08\u975e\u5e38\u5e38\u89c1\uff09"}),"\n",(0,n.jsx)(e.h3,{id:"\u601d\u60f3-7",children:"\u601d\u60f3"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["\u521a\u5f00\u59cb\u51e0\u767e / \u51e0\u5343 step\uff0clr \u4ece\u5f88\u5c0f",(0,n.jsx)(e.strong,{children:"\u7ebf\u6027\u5347\u5230\u76ee\u6807 lr"}),"\uff08warmup\uff09\uff1b"]}),"\n",(0,n.jsx)(e.li,{children:"\u7136\u540e\u518d\u63a5\u666e\u901a scheduler\uff08\u5982 Cosine\u3001MultiStep \u7b49\uff09\u3002"}),"\n"]}),"\n",(0,n.jsx)(e.p,{children:"\u539f\u56e0\uff1a"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"\u5927\u6a21\u578b + AdamW/Adam \u76f4\u63a5\u7ed9\u5927 lr\uff0c\u524d\u671f\u4e0d\u7a33\u5b9a\uff1b"}),"\n",(0,n.jsx)(e.li,{children:"warmup \u53ef\u4ee5\u8ba9\u4f18\u5316\u66f4\u5e73\u7a33\uff0c\u7279\u522b\u662f Transformer / LLM\u3002"}),"\n"]}),"\n",(0,n.jsx)(e.p,{children:"\u7b80\u5355\u4f2a\u4ee3\u7801\uff08\u771f\u5b9e\u9879\u76ee\u4e00\u822c\u81ea\u5df1\u5199\u4e2a wrapper \u6216\u7528\u5e93\uff09\uff1a"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"def get_lr(it):\n    if it < warmup_steps:\n        return base_lr * it / warmup_steps  # \u7ebf\u6027\u5347\n    # \u4e4b\u540e\u8d70\u4f59\u5f26\u9000\u706b\n    t = it - warmup_steps\n    T = total_steps - warmup_steps\n    return eta_min + 0.5 * (base_lr - eta_min) * (1 + math.cos(math.pi * t / T))\n"})}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsx)(e.h2,{id:"9-\u5982\u4f55\u9009",children:"9. \u5982\u4f55\u9009?"}),"\n",(0,n.jsx)(e.p,{children:"\u4e00\u4e2a\u975e\u5e38\u5b9e\u7528\u7684\u300c\u61d2\u4eba\u9009\u62e9\u300d\uff1a"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["\u5c0f\u9879\u76ee / \u5148\u8dd1\u901a\uff1a","\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:"AdamW + \u56fa\u5b9a lr"})," \u6216 ",(0,n.jsx)(e.code,{children:"AdamW + StepLR"})]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(e.li,{children:["CV / NLP \u4e2d\u7b49\u89c4\u6a21\u6a21\u578b\uff1a","\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"SGD/AdamW + Warmup + CosineAnnealingLR"})}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(e.li,{children:["\u60f3\u8981\u81ea\u52a8\u6839\u636e val_loss \u8c03\u6574\uff1a","\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"\u4efb\u610f optimizer + ReduceLROnPlateau"})}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(e.li,{children:["\u60f3\u6298\u817e\u4e00\u70b9\u3001\u8ffd\u6548\u679c\uff1a","\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:"Warmup + CosineAnnealingWarmRestarts"})," \u6216 ",(0,n.jsx)(e.code,{children:"OneCycleLR"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsx)(e.h2,{id:"10-\u4e00\u4e2a\u5178\u578b-pytorch-\u6a21\u677f",children:"10. \u4e00\u4e2a\u5178\u578b PyTorch \u6a21\u677f"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"optimizer = torch.optim.AdamW(model.parameters(), lr=3e-4, weight_decay=0.01)\n\n# \u4f8b\uff1a\u603b\u5171 100 epoch\uff0c\u4f7f\u7528\u4f59\u5f26\u9000\u706b\nscheduler = torch.optim.lr_scheduler.CosineAnnealingLR(\n    optimizer,\n    T_max=100,\n    eta_min=1e-6,\n)\n\nfor epoch in range(100):\n    model.train()\n    for batch in train_loader:\n        loss = ...\n        loss.backward()\n        optimizer.step()\n        optimizer.zero_grad()\n\n    scheduler.step()  # \u8c03\u6574\u5b66\u4e60\u7387\n"})})]})}function d(s={}){const{wrapper:e}={...(0,i.R)(),...s.components};return e?(0,n.jsx)(e,{...s,children:(0,n.jsx)(h,{...s})}):h(s)}},28453(s,e,a){a.d(e,{R:()=>c,x:()=>t});var l=a(96540);const n={},i=l.createContext(n);function c(s){const e=l.useContext(i);return l.useMemo(function(){return"function"==typeof s?s(e):{...e,...s}},[e,s])}function t(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(n):s.components||n:c(s.components),l.createElement(i.Provider,{value:e},s.children)}}}]);