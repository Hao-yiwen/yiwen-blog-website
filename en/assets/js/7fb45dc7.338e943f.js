"use strict";(globalThis.webpackChunkyiwen_blog_website=globalThis.webpackChunkyiwen_blog_website||[]).push([[84019],{27816(e,t,n){n.d(t,{A:()=>r});const r=n.p+"assets/images/event_deal-e6ec8b1346dbed7ec21c5167a5bd2f31.png"},28453(e,t,n){n.d(t,{R:()=>i,x:()=>o});var r=n(96540);const c={},s=r.createContext(c);function i(e){const t=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:i(e.components),r.createElement(s.Provider,{value:t},e.children)}},28826(e,t,n){n.d(t,{A:()=>r});const r=n.p+"assets/images/commit_phase-3edf318d4850e021f162f043e73de5b6.png"},69668(e,t,n){n.d(t,{A:()=>r});const r=n.p+"assets/images/click_deal-c95298488b944739bf3674f4bf0bfa80.png"},71438(e,t,n){n.d(t,{A:()=>r});const r=n.p+"assets/images/reconciler_stack-88c2f75b804be02f3a9212d4eeebbdb8.png"},75434(e,t,n){n.d(t,{A:()=>r});const r=n.p+"assets/images/concurrent-cc1c8ef47d5efc3d2fe985fc7525b8ee.png"},77117(e,t,n){n.d(t,{A:()=>r});const r=n.p+"assets/images/work_loop-6eb0b1d56cb007a84fd43b19c8eb27aa.png"},88316(e,t,n){n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"web/react_debugger/react_reconciler_debug","title":"react reconciler debug","description":"react\u8fd0\u884c\u5806\u6808","source":"@site/docs/web/react_debugger/react_reconciler_debug.md","sourceDirName":"web/react_debugger","slug":"/web/react_debugger/react_reconciler_debug","permalink":"/yiwen-blog-website/en/docs/web/react_debugger/react_reconciler_debug","draft":false,"unlisted":false,"editUrl":"https://github.com/Hao-yiwen/yiwen-blog-website/tree/master/docs/web/react_debugger/react_reconciler_debug.md","tags":[],"version":"current","lastUpdatedAt":1721001600000,"frontMatter":{"title":"react reconciler debug","sidebar_label":"react reconciler debug","date":"2024-07-14T00:00:00.000Z","last_update":{"date":"2024-07-15T00:00:00.000Z"}},"sidebar":"webSidebar","previous":{"title":"react\u603b\u89c8","permalink":"/yiwen-blog-website/en/docs/web/react_debugger/overview"},"next":{"title":"react\u7ec4\u4ef6\u90e8\u5206","permalink":"/yiwen-blog-website/en/docs/web/react_debugger/react_struct"}}');var c=n(74848),s=n(28453);const i={title:"react reconciler debug",sidebar_label:"react reconciler debug",date:new Date("2024-07-14T00:00:00.000Z"),last_update:{date:new Date("2024-07-15T00:00:00.000Z")}},o=void 0,a={},d=[{value:"react\u8fd0\u884c\u5806\u6808",id:"react\u8fd0\u884c\u5806\u6808",level:2},{value:"ensureRootIsScheduled",id:"ensurerootisscheduled",level:2},{value:"performConcurrentWorkOnRoot",id:"performconcurrentworkonroot",level:2},{value:"\u63d0\u4ea4\u9636\u6bb5",id:"\u63d0\u4ea4\u9636\u6bb5",level:2},{value:"\u521d\u59cb\u5316\u4efb\u52a1\u8c03\u5ea6",id:"\u521d\u59cb\u5316\u4efb\u52a1\u8c03\u5ea6",level:2},{value:"\u4e8b\u4ef6\u54cd\u5e94",id:"\u4e8b\u4ef6\u54cd\u5e94",level:2}];function l(e){const t={code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(t.h2,{id:"react\u8fd0\u884c\u5806\u6808",children:"react\u8fd0\u884c\u5806\u6808"}),"\n",(0,c.jsx)(t.p,{children:"\u4e00\u6b21\u4ece\u8bd5\u56fe\u521b\u5efa\u5230\u771f\u5b9edom\u521b\u5efa\u7684\u8fc7\u7a0b\u3002"}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.img,{alt:"reconciler_stack",src:n(71438).A+"",width:"1672",height:"952"})}),"\n",(0,c.jsx)(t.h2,{id:"ensurerootisscheduled",children:"ensureRootIsScheduled"}),"\n",(0,c.jsx)(t.p,{children:"\u4efb\u52a1\u603b\u8c03\u5ea6\u7684\u5730\u65b9\u3002\u53ea\u8981\u7528\u65f6\u95f4\u5207\u7247\u8fd8\u662f\u4e0d\u5207\u7247\uff0c\u4e00\u5207\u770b\u4efb\u52a1\u4f18\u5148\u7ea7\u3002\u9875\u9762\u521d\u59cb\u5316\u7684\u65f6\u5019\u4f18\u5148\u7ea7\u662fnormal\u4f18\u5148\u7ea7\uff0c\u4f18\u5148\u7ea7\u662f3\u3002\u8d70\u65f6\u95f4\u5207\u7247\u6e32\u67d3\u3002"}),"\n",(0,c.jsx)(t.h2,{id:"performconcurrentworkonroot",children:"performConcurrentWorkOnRoot"}),"\n",(0,c.jsx)(t.p,{children:"\u8fd9\u662f\u5e76\u53d1\u4efb\u52a1\u7684\u603b\u5165\u53e3\uff0c\u5305\u62ec\u5904\u7406\u6e32\u67d3\u5de5\u4f5c\u548c\u63d0\u4ea4\u9636\u6bb5\u5de5\u4f5c\uff08\u526f\u4f5c\u7528\u51fd\u6570\uff09"}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.img,{alt:"concurrent",src:n(75434).A+"",width:"694",height:"116"})}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.img,{alt:"commit_phase",src:n(28826).A+"",width:"1046",height:"674"})}),"\n",(0,c.jsx)(t.h2,{id:"\u63d0\u4ea4\u9636\u6bb5",children:"\u63d0\u4ea4\u9636\u6bb5"}),"\n",(0,c.jsxs)(t.ol,{children:["\n",(0,c.jsx)(t.li,{children:"Before Mutation Phase: \u5728\u8fdb\u884c\u4efb\u4f55 DOM \u53d8\u66f4\u4e4b\u524d\uff0cReact \u4f1a\u5904\u7406\u4e00\u4e9b\u751f\u547d\u5468\u671f\u65b9\u6cd5\uff08\u5982 getSnapshotBeforeUpdate\uff09\uff0c\u5e76\u8c03\u7528\u5408\u9002\u7684\u94a9\u5b50\u3002"}),"\n",(0,c.jsx)(t.li,{children:"Mutation Phase: \u5728\u8fd9\u4e2a\u9636\u6bb5\uff0cReact \u4f1a\u5b9e\u9645\u6267\u884c\u6240\u6709\u9700\u8981\u7684 DOM \u53d8\u66f4\u3002\u524d\u9762\u6e32\u67d3\u9636\u6bb5\u53ea\u662f\u521b\u5efa\u597d\u4e86dom\u8282\u70b9\uff0c\u4f46\u662f\u8fd9\u91cc\u662f\u771f\u7684\u6302\u5728\u6e32\u67d3\u3002(commitMutationEffect\u51fd\u6570\u662f\u771f\u6b63\u6e32\u67d3\u7684\u6267\u884c\u51fd\u6570)"}),"\n",(0,c.jsx)(t.li,{children:"Layout Phase: \u5728 DOM \u53d8\u66f4\u5b8c\u6210\u540e\uff0cReact \u4f1a\u5904\u7406 componentDidMount \u548c componentDidUpdate \u751f\u547d\u5468\u671f\u65b9\u6cd5\uff0c\u5e76\u8c03\u7528 useLayoutEffect \u94a9\u5b50\u3002"}),"\n",(0,c.jsx)(t.li,{children:"Passive Effects Phase: \u6700\u540e\uff0cReact \u4f1a\u5904\u7406 useEffect \u94a9\u5b50\u4e2d\u7684\u526f\u4f5c\u7528\u3002"}),"\n"]}),"\n",(0,c.jsx)(t.h2,{id:"\u521d\u59cb\u5316\u4efb\u52a1\u8c03\u5ea6",children:"\u521d\u59cb\u5316\u4efb\u52a1\u8c03\u5ea6"}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.img,{alt:"work_loop",src:n(77117).A+"",width:"2434",height:"1344"})}),"\n",(0,c.jsx)(t.p,{children:"\u5728\u521d\u59cb\u5316\u7684react\u4e8b\u4ef6\u8c03\u5ea6\u4e2d\uff0c\u5728\u65b0\u7248\u6d4f\u89c8\u5668\u4f1a\u4f7f\u7528web work\u5728\u5176\u4ed6\u7ebf\u7a0b\u521b\u5efa\u4e00\u4e2a\u4e8b\u4ef6\u8c03\u5ea6\u5faa\u73af\uff0c\u6765\u7edf\u4e00\u521b\u5efafiber\uff0c\u9875\u9762\u66f4\u65b0\uff0c\u526f\u4f5c\u7528\u51fd\u6570\u6267\u884c\u3002"}),"\n",(0,c.jsx)(t.h2,{id:"\u4e8b\u4ef6\u54cd\u5e94",children:"\u4e8b\u4ef6\u54cd\u5e94"}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-js",children:"<button onClick={() => setCount(count + 1)}>count++</button>\n"})}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.img,{alt:"event_deal text",src:n(27816).A+"",width:"1554",height:"926"})}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.img,{alt:"click_deal",src:n(69668).A+"",width:"1018",height:"380"})})]})}function u(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,c.jsx)(t,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}}}]);