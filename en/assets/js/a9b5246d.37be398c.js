"use strict";(globalThis.webpackChunkyiwen_blog_website=globalThis.webpackChunkyiwen_blog_website||[]).push([[7118],{28453(n,e,d){d.d(e,{R:()=>i,x:()=>r});var a=d(96540);const l={},s=a.createContext(l);function i(n){const e=a.useContext(s);return a.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:i(n.components),a.createElement(s.Provider,{value:e},n.children)}},56977(n,e,d){d.r(e),d.d(e,{assets:()=>t,contentTitle:()=>r,default:()=>f,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"ai/python/pandas-cheatsheet","title":"Pandas \u5e38\u7528\u64cd\u4f5c\u901f\u67e5\u624b\u518c","description":"\ud83d\udce6 \u5bfc\u5165\u548c\u521b\u5efa","source":"@site/docs/ai/python/pandas-cheatsheet.md","sourceDirName":"ai/python","slug":"/ai/python/pandas-cheatsheet","permalink":"/yiwen-blog-website/en/docs/ai/python/pandas-cheatsheet","draft":false,"unlisted":false,"editUrl":"https://github.com/Hao-yiwen/yiwen-blog-website/tree/master/docs/ai/python/pandas-cheatsheet.md","tags":[],"version":"current","lastUpdatedAt":1762387200000,"frontMatter":{"title":"Pandas \u5e38\u7528\u64cd\u4f5c\u901f\u67e5\u624b\u518c","sidebar_label":"Pandas \u901f\u67e5\u624b\u518c","date":"2025-11-06T00:00:00.000Z","last_update":{"date":"2025-11-06T00:00:00.000Z"}},"sidebar":"aiSidebar","previous":{"title":"pip \u53ef\u9009\u4f9d\u8d56 [extras]","permalink":"/yiwen-blog-website/en/docs/ai/python/optional_pip"},"next":{"title":"pip vs pipx - \u533a\u522b\u8be6\u89e3","permalink":"/yiwen-blog-website/en/docs/ai/python/pipx"}}');var l=d(74848),s=d(28453);const i={title:"Pandas \u5e38\u7528\u64cd\u4f5c\u901f\u67e5\u624b\u518c",sidebar_label:"Pandas \u901f\u67e5\u624b\u518c",date:new Date("2025-11-06T00:00:00.000Z"),last_update:{date:new Date("2025-11-06T00:00:00.000Z")}},r="Pandas \u5e38\u7528\u64cd\u4f5c\u901f\u67e5\u624b\u518c",t={},c=[{value:"\ud83d\udce6 \u5bfc\u5165\u548c\u521b\u5efa",id:"-\u5bfc\u5165\u548c\u521b\u5efa",level:2},{value:"\ud83d\udcc2 \u6570\u636e\u8bfb\u53d6\u548c\u4fdd\u5b58",id:"-\u6570\u636e\u8bfb\u53d6\u548c\u4fdd\u5b58",level:2},{value:"\ud83d\udc40 \u6570\u636e\u67e5\u770b",id:"-\u6570\u636e\u67e5\u770b",level:2},{value:"\ud83d\udd0d \u6570\u636e\u9009\u62e9\u548c\u7d22\u5f15",id:"-\u6570\u636e\u9009\u62e9\u548c\u7d22\u5f15",level:2},{value:"\u9009\u62e9\u5217",id:"\u9009\u62e9\u5217",level:3},{value:"\u9009\u62e9\u884c",id:"\u9009\u62e9\u884c",level:3},{value:"\u6761\u4ef6\u7b5b\u9009",id:"\u6761\u4ef6\u7b5b\u9009",level:3},{value:"\ud83d\udd27 \u6570\u636e\u6e05\u6d17",id:"-\u6570\u636e\u6e05\u6d17",level:2},{value:"\u7f3a\u5931\u503c\u5904\u7406",id:"\u7f3a\u5931\u503c\u5904\u7406",level:3},{value:"\u91cd\u590d\u503c\u5904\u7406",id:"\u91cd\u590d\u503c\u5904\u7406",level:3},{value:"\u6570\u636e\u7c7b\u578b\u8f6c\u6362",id:"\u6570\u636e\u7c7b\u578b\u8f6c\u6362",level:3},{value:"\u270f\ufe0f \u6570\u636e\u4fee\u6539",id:"\ufe0f-\u6570\u636e\u4fee\u6539",level:2},{value:"\u6dfb\u52a0/\u5220\u9664\u5217",id:"\u6dfb\u52a0\u5220\u9664\u5217",level:3},{value:"\u91cd\u547d\u540d",id:"\u91cd\u547d\u540d",level:3},{value:"\u4fee\u6539\u503c",id:"\u4fee\u6539\u503c",level:3},{value:"\ud83d\udd04 \u6570\u636e\u8f6c\u6362",id:"-\u6570\u636e\u8f6c\u6362",level:2},{value:"Apply \u51fd\u6570",id:"apply-\u51fd\u6570",level:3},{value:"\u72ec\u70ed\u7f16\u7801(One-Hot Encoding)",id:"\u72ec\u70ed\u7f16\u7801one-hot-encoding",level:3},{value:"\u6392\u5e8f",id:"\u6392\u5e8f",level:3},{value:"\u5206\u7ec4\u64cd\u4f5c",id:"\u5206\u7ec4\u64cd\u4f5c",level:3},{value:"\ud83d\udd17 \u6570\u636e\u5408\u5e76",id:"-\u6570\u636e\u5408\u5e76",level:2},{value:"Concat(\u62fc\u63a5)",id:"concat\u62fc\u63a5",level:3},{value:"Merge(\u5408\u5e76)",id:"merge\u5408\u5e76",level:3},{value:"Join(\u8fde\u63a5)",id:"join\u8fde\u63a5",level:3},{value:"\ud83d\udcca \u6570\u636e\u900f\u89c6\u548c\u91cd\u5851",id:"-\u6570\u636e\u900f\u89c6\u548c\u91cd\u5851",level:2},{value:"Pivot(\u900f\u89c6)",id:"pivot\u900f\u89c6",level:3},{value:"Melt(\u9006\u900f\u89c6)",id:"melt\u9006\u900f\u89c6",level:3},{value:"Stack/Unstack",id:"stackunstack",level:3},{value:"\ud83d\udcc8 \u5b57\u7b26\u4e32\u64cd\u4f5c",id:"-\u5b57\u7b26\u4e32\u64cd\u4f5c",level:2},{value:"\ud83d\udcc5 \u65e5\u671f\u65f6\u95f4\u64cd\u4f5c",id:"-\u65e5\u671f\u65f6\u95f4\u64cd\u4f5c",level:2},{value:"\ud83c\udfaf \u5b9e\u7528\u6280\u5de7",id:"-\u5b9e\u7528\u6280\u5de7",level:2},{value:"\u94fe\u5f0f\u64cd\u4f5c",id:"\u94fe\u5f0f\u64cd\u4f5c",level:3},{value:"\u8bbe\u7f6e\u663e\u793a\u9009\u9879",id:"\u8bbe\u7f6e\u663e\u793a\u9009\u9879",level:3},{value:"\u6027\u80fd\u4f18\u5316",id:"\u6027\u80fd\u4f18\u5316",level:3},{value:"\ud83d\udca1 \u5e38\u89c1\u6570\u636e\u6e05\u6d17\u6d41\u7a0b",id:"-\u5e38\u89c1\u6570\u636e\u6e05\u6d17\u6d41\u7a0b",level:2},{value:"\ud83d\udd0d \u5feb\u901f\u67e5\u627e\u548c\u7d22\u5f15",id:"-\u5feb\u901f\u67e5\u627e\u548c\u7d22\u5f15",level:2},{value:"\ud83d\udcdd \u5c0f\u6284\u901f\u67e5",id:"-\u5c0f\u6284\u901f\u67e5",level:2}];function o(n){const e={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"pandas-\u5e38\u7528\u64cd\u4f5c\u901f\u67e5\u624b\u518c",children:"Pandas \u5e38\u7528\u64cd\u4f5c\u901f\u67e5\u624b\u518c"})}),"\n",(0,l.jsx)(e.h2,{id:"-\u5bfc\u5165\u548c\u521b\u5efa",children:"\ud83d\udce6 \u5bfc\u5165\u548c\u521b\u5efa"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"import pandas as pd\nimport numpy as np\n\n# \u521b\u5efa DataFrame\ndf = pd.DataFrame({\n    'A': [1, 2, 3, 4],\n    'B': ['a', 'b', 'c', 'd'],\n    'C': [1.1, 2.2, 3.3, 4.4]\n})\n\n# \u521b\u5efa Series\ns = pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])\n\n# \u4ece\u5b57\u5178\u521b\u5efa(\u6307\u5b9a\u7d22\u5f15)\ndf = pd.DataFrame({\n    'col1': [1, 2],\n    'col2': [3, 4]\n}, index=['row1', 'row2'])\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"-\u6570\u636e\u8bfb\u53d6\u548c\u4fdd\u5b58",children:"\ud83d\udcc2 \u6570\u636e\u8bfb\u53d6\u548c\u4fdd\u5b58"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# CSV \u6587\u4ef6\ndf = pd.read_csv('file.csv')\ndf = pd.read_csv('file.csv', encoding='utf-8')  # \u6307\u5b9a\u7f16\u7801\ndf = pd.read_csv('file.csv', sep='\\t')          # \u6307\u5b9a\u5206\u9694\u7b26\ndf.to_csv('output.csv', index=False)            # \u4fdd\u5b58(\u4e0d\u4fdd\u5b58\u7d22\u5f15)\n\n# Excel \u6587\u4ef6\ndf = pd.read_excel('file.xlsx', sheet_name='Sheet1')\ndf.to_excel('output.xlsx', index=False)\n\n# JSON \u6587\u4ef6\ndf = pd.read_json('file.json')\ndf.to_json('output.json')\n\n# SQL \u6570\u636e\u5e93\nimport sqlite3\nconn = sqlite3.connect('database.db')\ndf = pd.read_sql('SELECT * FROM table', conn)\ndf.to_sql('table_name', conn, if_exists='replace')\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"-\u6570\u636e\u67e5\u770b",children:"\ud83d\udc40 \u6570\u636e\u67e5\u770b"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u57fa\u672c\u4fe1\u606f\ndf.head()           # \u524d5\u884c\ndf.head(10)         # \u524d10\u884c\ndf.tail()           # \u540e5\u884c\ndf.sample(5)        # \u968f\u673a5\u884c\n\n# \u6570\u636e\u6982\u89c8\ndf.shape            # (\u884c\u6570, \u5217\u6570)\ndf.info()           # \u6570\u636e\u7c7b\u578b\u3001\u975e\u7a7a\u503c\u6570\u91cf\ndf.describe()       # \u6570\u503c\u5217\u7684\u7edf\u8ba1\u6458\u8981\ndf.dtypes           # \u6bcf\u5217\u7684\u6570\u636e\u7c7b\u578b\ndf.columns          # \u5217\u540d\ndf.index            # \u7d22\u5f15\n\n# \u7edf\u8ba1\u4fe1\u606f\ndf.count()          # \u975e\u7a7a\u503c\u6570\u91cf\ndf.mean()           # \u5e73\u5747\u503c\ndf.median()         # \u4e2d\u4f4d\u6570\ndf.std()            # \u6807\u51c6\u5dee\ndf.min()            # \u6700\u5c0f\u503c\ndf.max()            # \u6700\u5927\u503c\ndf.sum()            # \u6c42\u548c\ndf.value_counts()   # Series \u7684\u503c\u8ba1\u6570\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"-\u6570\u636e\u9009\u62e9\u548c\u7d22\u5f15",children:"\ud83d\udd0d \u6570\u636e\u9009\u62e9\u548c\u7d22\u5f15"}),"\n",(0,l.jsx)(e.h3,{id:"\u9009\u62e9\u5217",children:"\u9009\u62e9\u5217"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"df['A']                 # \u9009\u62e9\u5355\u5217(\u8fd4\u56de Series)\ndf[['A', 'B']]          # \u9009\u62e9\u591a\u5217(\u8fd4\u56de DataFrame)\ndf.A                    # \u901a\u8fc7\u5c5e\u6027\u8bbf\u95ee(\u4e0d\u63a8\u8350\u7528\u4e8e\u6709\u7a7a\u683c\u7684\u5217\u540d)\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\u9009\u62e9\u884c",children:"\u9009\u62e9\u884c"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u57fa\u4e8e\u4f4d\u7f6e - iloc\ndf.iloc[0]              # \u7b2c\u4e00\u884c\ndf.iloc[0:3]            # \u524d3\u884c\ndf.iloc[[0, 2, 4]]      # \u7279\u5b9a\u884c\ndf.iloc[:, 0:2]         # \u6240\u6709\u884c,\u524d2\u5217\n\n# \u57fa\u4e8e\u6807\u7b7e - loc\ndf.loc[0]               # \u7d22\u5f15\u4e3a0\u7684\u884c\ndf.loc[0:3]             # \u7d22\u5f150\u52303(\u5305\u62ec3)\ndf.loc[:, 'A':'C']      # \u6240\u6709\u884c,\u5217A\u5230C\ndf.loc[df['A'] > 2]     # \u6761\u4ef6\u7b5b\u9009\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\u6761\u4ef6\u7b5b\u9009",children:"\u6761\u4ef6\u7b5b\u9009"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u5355\u6761\u4ef6\ndf[df['A'] > 2]\ndf[df['B'] == 'a']\n\n# \u591a\u6761\u4ef6(\u4e0e)\ndf[(df['A'] > 2) & (df['B'] == 'a')]\n\n# \u591a\u6761\u4ef6(\u6216)\ndf[(df['A'] > 2) | (df['B'] == 'a')]\n\n# \u53d6\u53cd\ndf[~(df['A'] > 2)]\n\n# isin \u65b9\u6cd5\ndf[df['B'].isin(['a', 'b'])]\n\n# \u5b57\u7b26\u4e32\u5305\u542b\ndf[df['B'].str.contains('a')]\n\n# \u67e5\u8be2\u8bed\u6cd5(\u66f4\u7b80\u6d01)\ndf.query('A > 2 and B == \"a\"')\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"-\u6570\u636e\u6e05\u6d17",children:"\ud83d\udd27 \u6570\u636e\u6e05\u6d17"}),"\n",(0,l.jsx)(e.h3,{id:"\u7f3a\u5931\u503c\u5904\u7406",children:"\u7f3a\u5931\u503c\u5904\u7406"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u68c0\u67e5\u7f3a\u5931\u503c\ndf.isnull()             # \u8fd4\u56de\u5e03\u5c14 DataFrame\ndf.isnull().sum()       # \u6bcf\u5217\u7f3a\u5931\u503c\u6570\u91cf\ndf.isnull().any()       # \u6bcf\u5217\u662f\u5426\u6709\u7f3a\u5931\u503c\n\n# \u5220\u9664\u7f3a\u5931\u503c\ndf.dropna()             # \u5220\u9664\u4efb\u4f55\u5305\u542b\u7f3a\u5931\u503c\u7684\u884c\ndf.dropna(axis=1)       # \u5220\u9664\u4efb\u4f55\u5305\u542b\u7f3a\u5931\u503c\u7684\u5217\ndf.dropna(how='all')    # \u5220\u9664\u5168\u4e3a\u7f3a\u5931\u503c\u7684\u884c\ndf.dropna(thresh=2)     # \u4fdd\u7559\u81f3\u5c11\u67092\u4e2a\u975e\u7a7a\u503c\u7684\u884c\n\n# \u586b\u5145\u7f3a\u5931\u503c\ndf.fillna(0)            # \u75280\u586b\u5145\ndf.fillna(method='ffill')   # \u524d\u5411\u586b\u5145\ndf.fillna(method='bfill')   # \u540e\u5411\u586b\u5145\ndf['A'].fillna(df['A'].mean())  # \u7528\u5e73\u5747\u503c\u586b\u5145\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\u91cd\u590d\u503c\u5904\u7406",children:"\u91cd\u590d\u503c\u5904\u7406"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u68c0\u67e5\u91cd\u590d\ndf.duplicated()         # \u8fd4\u56de\u5e03\u5c14 Series\ndf.duplicated().sum()   # \u91cd\u590d\u884c\u6570\u91cf\n\n# \u5220\u9664\u91cd\u590d\ndf.drop_duplicates()    # \u5220\u9664\u91cd\u590d\u884c(\u4fdd\u7559\u7b2c\u4e00\u6b21\u51fa\u73b0)\ndf.drop_duplicates(keep='last')     # \u4fdd\u7559\u6700\u540e\u4e00\u6b21\u51fa\u73b0\ndf.drop_duplicates(subset=['A'])    # \u57fa\u4e8e\u7279\u5b9a\u5217\u5224\u65ad\u91cd\u590d\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\u6570\u636e\u7c7b\u578b\u8f6c\u6362",children:"\u6570\u636e\u7c7b\u578b\u8f6c\u6362"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u8f6c\u6362\u5355\u5217\ndf['A'] = df['A'].astype(int)\ndf['B'] = df['B'].astype(str)\ndf['C'] = pd.to_numeric(df['C'], errors='coerce')  # \u65e0\u6cd5\u8f6c\u6362\u7684\u8bbe\u4e3a NaN\n\n# \u8f6c\u6362\u591a\u5217\ndf = df.astype({'A': int, 'B': str})\n\n# \u65e5\u671f\u65f6\u95f4\u8f6c\u6362\ndf['date'] = pd.to_datetime(df['date'])\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\ufe0f-\u6570\u636e\u4fee\u6539",children:"\u270f\ufe0f \u6570\u636e\u4fee\u6539"}),"\n",(0,l.jsx)(e.h3,{id:"\u6dfb\u52a0\u5220\u9664\u5217",children:"\u6dfb\u52a0/\u5220\u9664\u5217"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u6dfb\u52a0\u5217\ndf['D'] = [5, 6, 7, 8]          # \u76f4\u63a5\u8d4b\u503c\ndf['E'] = df['A'] + df['C']     # \u8ba1\u7b97\u5f97\u5230\ndf.insert(1, 'F', [9, 10, 11, 12])  # \u5728\u6307\u5b9a\u4f4d\u7f6e\u63d2\u5165\n\n# \u5220\u9664\u5217\ndf.drop('D', axis=1, inplace=True)      # \u5220\u9664\u5355\u5217\ndf.drop(['D', 'E'], axis=1, inplace=True)   # \u5220\u9664\u591a\u5217\ndel df['F']                             # \u76f4\u63a5\u5220\u9664\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\u91cd\u547d\u540d",children:"\u91cd\u547d\u540d"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u91cd\u547d\u540d\u5217\ndf.rename(columns={'A': 'new_A', 'B': 'new_B'}, inplace=True)\ndf.columns = ['col1', 'col2', 'col3']   # \u91cd\u547d\u540d\u6240\u6709\u5217\n\n# \u91cd\u547d\u540d\u7d22\u5f15\ndf.rename(index={0: 'row1', 1: 'row2'}, inplace=True)\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\u4fee\u6539\u503c",children:"\u4fee\u6539\u503c"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u4fee\u6539\u5355\u4e2a\u503c\ndf.loc[0, 'A'] = 100\ndf.iloc[0, 0] = 100\n\n# \u4fee\u6539\u6574\u5217\ndf['A'] = 0\ndf['A'] = df['A'] * 2\n\n# \u6761\u4ef6\u4fee\u6539\ndf.loc[df['A'] > 2, 'B'] = 'high'\n\n# \u4f7f\u7528 replace\ndf['B'].replace('a', 'new_a', inplace=True)\ndf.replace({'a': 'new_a', 'b': 'new_b'}, inplace=True)\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"-\u6570\u636e\u8f6c\u6362",children:"\ud83d\udd04 \u6570\u636e\u8f6c\u6362"}),"\n",(0,l.jsx)(e.h3,{id:"apply-\u51fd\u6570",children:"Apply \u51fd\u6570"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u5bf9\u5217\u5e94\u7528\u51fd\u6570\ndf['A'].apply(lambda x: x * 2)\ndf['A'].apply(np.sqrt)\n\n# \u5bf9 DataFrame \u5e94\u7528\u51fd\u6570\ndf.apply(lambda x: x.max() - x.min())   # \u5bf9\u6bcf\u5217\ndf.apply(lambda x: x.max() - x.min(), axis=1)  # \u5bf9\u6bcf\u884c\n\n# map(\u4ec5\u7528\u4e8e Series)\ndf['B'].map({'a': 1, 'b': 2, 'c': 3})\n\n# applymap(\u5bf9\u6bcf\u4e2a\u5143\u7d20) - \u5df2\u5f03\u7528,\u4f7f\u7528 map\ndf[['A', 'C']].map(lambda x: x * 2)\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\u72ec\u70ed\u7f16\u7801one-hot-encoding",children:"\u72ec\u70ed\u7f16\u7801(One-Hot Encoding)"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u57fa\u672c\u7528\u6cd5 - \u5c06\u7c7b\u522b\u578b\u53d8\u91cf\u8f6c\u6362\u4e3a 0/1 \u865a\u62df\u53d8\u91cf\ndf = pd.DataFrame({\n    'color': ['red', 'blue', 'green', 'red'],\n    'size': ['S', 'M', 'L', 'M'],\n    'price': [10, 20, 30, 15]\n})\n\n# \u5bf9\u6240\u6709\u975e\u6570\u503c\u5217\u81ea\u52a8\u7f16\u7801\npd.get_dummies(df)\n# \u7ed3\u679c: price, color_blue, color_green, color_red, size_L, size_M, size_S\n\n# \u53ea\u5bf9\u7279\u5b9a\u5217\u7f16\u7801\npd.get_dummies(df, columns=['color'])\n\n# \u6307\u5b9a\u5217\u540d\u524d\u7f00\npd.get_dummies(df, prefix={'color': '\u989c\u8272', 'size': '\u5c3a\u5bf8'})\n\n# \u5220\u9664\u7b2c\u4e00\u5217(\u907f\u514d\u591a\u91cd\u5171\u7ebf\u6027,\u7528\u4e8e\u7ebf\u6027\u56de\u5f52)\npd.get_dummies(df, drop_first=True)\n\n# \u5904\u7406\u7f3a\u5931\u503c\npd.get_dummies(df, dummy_na=True)\n\n# \u5b9e\u9645\u5e94\u7528:\u8bad\u7ec3\u96c6\u548c\u6d4b\u8bd5\u96c6\u4e00\u81f4\u6027\u7f16\u7801\nall_data = pd.concat([train_df, test_df])\nall_encoded = pd.get_dummies(all_data, columns=['category_col'])\ntrain_encoded = all_encoded[:len(train_df)]\ntest_encoded = all_encoded[len(train_df):]\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\u6392\u5e8f",children:"\u6392\u5e8f"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u6309\u503c\u6392\u5e8f\ndf.sort_values('A')                     # \u5347\u5e8f\ndf.sort_values('A', ascending=False)    # \u964d\u5e8f\ndf.sort_values(['A', 'B'])              # \u591a\u5217\u6392\u5e8f\ndf.sort_values('A', inplace=True)       # \u539f\u5730\u6392\u5e8f\n\n# \u6309\u7d22\u5f15\u6392\u5e8f\ndf.sort_index()\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\u5206\u7ec4\u64cd\u4f5c",children:"\u5206\u7ec4\u64cd\u4f5c"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u57fa\u672c\u5206\u7ec4\ndf.groupby('B').mean()          # \u6309B\u5217\u5206\u7ec4,\u8ba1\u7b97\u5e73\u5747\u503c\ndf.groupby('B').sum()           # \u6c42\u548c\ndf.groupby('B').count()         # \u8ba1\u6570\ndf.groupby('B').size()          # \u6bcf\u7ec4\u5927\u5c0f\n\n# \u591a\u5217\u5206\u7ec4\ndf.groupby(['B', 'C']).mean()\n\n# \u805a\u5408\u591a\u4e2a\u7edf\u8ba1\u91cf\ndf.groupby('B').agg(['mean', 'sum', 'count'])\n\n# \u5bf9\u4e0d\u540c\u5217\u5e94\u7528\u4e0d\u540c\u805a\u5408\ndf.groupby('B').agg({\n    'A': 'mean',\n    'C': ['sum', 'max']\n})\n\n# \u81ea\u5b9a\u4e49\u805a\u5408\u51fd\u6570\ndf.groupby('B').agg(lambda x: x.max() - x.min())\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"-\u6570\u636e\u5408\u5e76",children:"\ud83d\udd17 \u6570\u636e\u5408\u5e76"}),"\n",(0,l.jsx)(e.h3,{id:"concat\u62fc\u63a5",children:"Concat(\u62fc\u63a5)"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u5782\u76f4\u62fc\u63a5(\u884c)\npd.concat([df1, df2], axis=0)\npd.concat([df1, df2], ignore_index=True)  # \u91cd\u7f6e\u7d22\u5f15\n\n# \u6c34\u5e73\u62fc\u63a5(\u5217)\npd.concat([df1, df2], axis=1)\n"})}),"\n",(0,l.jsx)(e.h3,{id:"merge\u5408\u5e76",children:"Merge(\u5408\u5e76)"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u5185\u8fde\u63a5(\u9ed8\u8ba4)\npd.merge(df1, df2, on='key')\n\n# \u5de6\u8fde\u63a5\npd.merge(df1, df2, on='key', how='left')\n\n# \u53f3\u8fde\u63a5\npd.merge(df1, df2, on='key', how='right')\n\n# \u5916\u8fde\u63a5\npd.merge(df1, df2, on='key', how='outer')\n\n# \u591a\u4e2a\u952e\npd.merge(df1, df2, on=['key1', 'key2'])\n\n# \u4e0d\u540c\u5217\u540d\u7684\u952e\npd.merge(df1, df2, left_on='key1', right_on='key2')\n"})}),"\n",(0,l.jsx)(e.h3,{id:"join\u8fde\u63a5",children:"Join(\u8fde\u63a5)"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u57fa\u4e8e\u7d22\u5f15\u8fde\u63a5\ndf1.join(df2)\ndf1.join(df2, how='left')\ndf1.join(df2, lsuffix='_left', rsuffix='_right')  # \u5904\u7406\u91cd\u590d\u5217\u540d\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"-\u6570\u636e\u900f\u89c6\u548c\u91cd\u5851",children:"\ud83d\udcca \u6570\u636e\u900f\u89c6\u548c\u91cd\u5851"}),"\n",(0,l.jsx)(e.h3,{id:"pivot\u900f\u89c6",children:"Pivot(\u900f\u89c6)"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u521b\u5efa\u900f\u89c6\u8868\ndf.pivot(index='date', columns='category', values='value')\n\n# \u900f\u89c6\u8868(\u652f\u6301\u805a\u5408)\ndf.pivot_table(\n    values='value',\n    index='date',\n    columns='category',\n    aggfunc='mean'\n)\n"})}),"\n",(0,l.jsx)(e.h3,{id:"melt\u9006\u900f\u89c6",children:"Melt(\u9006\u900f\u89c6)"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u5bbd\u683c\u5f0f\u8f6c\u957f\u683c\u5f0f\npd.melt(df, id_vars=['id'], value_vars=['A', 'B', 'C'])\n"})}),"\n",(0,l.jsx)(e.h3,{id:"stackunstack",children:"Stack/Unstack"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# Stack:\u5217\u8f6c\u884c\ndf.stack()\n\n# Unstack:\u884c\u8f6c\u5217\ndf.unstack()\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"-\u5b57\u7b26\u4e32\u64cd\u4f5c",children:"\ud83d\udcc8 \u5b57\u7b26\u4e32\u64cd\u4f5c"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u5b57\u7b26\u4e32\u65b9\u6cd5(\u9700\u8981 .str \u8bbf\u95ee\u5668)\ndf['B'].str.upper()             # \u8f6c\u5927\u5199\ndf['B'].str.lower()             # \u8f6c\u5c0f\u5199\ndf['B'].str.strip()             # \u53bb\u9664\u7a7a\u683c\ndf['B'].str.replace('a', 'A')   # \u66ff\u6362\ndf['B'].str.contains('a')       # \u662f\u5426\u5305\u542b\ndf['B'].str.startswith('a')     # \u662f\u5426\u4ee5...\u5f00\u5934\ndf['B'].str.endswith('a')       # \u662f\u5426\u4ee5...\u7ed3\u5c3e\ndf['B'].str.split('_')          # \u5206\u5272\ndf['B'].str.len()               # \u5b57\u7b26\u4e32\u957f\u5ea6\ndf['B'].str[0]                  # \u53d6\u7b2c\u4e00\u4e2a\u5b57\u7b26\ndf['B'].str[:3]                 # \u5207\u7247\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"-\u65e5\u671f\u65f6\u95f4\u64cd\u4f5c",children:"\ud83d\udcc5 \u65e5\u671f\u65f6\u95f4\u64cd\u4f5c"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u521b\u5efa\u65e5\u671f\u8303\u56f4\ndates = pd.date_range('2024-01-01', periods=10, freq='D')\n\n# \u65e5\u671f\u65f6\u95f4\u5c5e\u6027\ndf['date'].dt.year              # \u5e74\ndf['date'].dt.month             # \u6708\ndf['date'].dt.day               # \u65e5\ndf['date'].dt.dayofweek         # \u661f\u671f\u51e0(0=\u5468\u4e00)\ndf['date'].dt.hour              # \u5c0f\u65f6\ndf['date'].dt.minute            # \u5206\u949f\n\n# \u65e5\u671f\u8ba1\u7b97\ndf['date'] + pd.Timedelta(days=7)       # \u52a07\u5929\ndf['date'] - pd.Timedelta(hours=2)      # \u51cf2\u5c0f\u65f6\n\n# \u8bbe\u7f6e\u65e5\u671f\u4e3a\u7d22\u5f15\ndf.set_index('date', inplace=True)\n\n# \u6309\u65f6\u95f4\u7b5b\u9009\ndf['2024']                      # 2024\u5e74\u7684\u6570\u636e\ndf['2024-01']                   # 2024\u5e741\u6708\u7684\u6570\u636e\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"-\u5b9e\u7528\u6280\u5de7",children:"\ud83c\udfaf \u5b9e\u7528\u6280\u5de7"}),"\n",(0,l.jsx)(e.h3,{id:"\u94fe\u5f0f\u64cd\u4f5c",children:"\u94fe\u5f0f\u64cd\u4f5c"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"result = (df\n    .dropna()\n    .query('A > 2')\n    .groupby('B')\n    .mean()\n    .sort_values('A', ascending=False)\n)\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\u8bbe\u7f6e\u663e\u793a\u9009\u9879",children:"\u8bbe\u7f6e\u663e\u793a\u9009\u9879"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"pd.set_option('display.max_rows', 100)      # \u6700\u5927\u663e\u793a\u884c\u6570\npd.set_option('display.max_columns', 20)    # \u6700\u5927\u663e\u793a\u5217\u6570\npd.set_option('display.width', 1000)        # \u663e\u793a\u5bbd\u5ea6\npd.set_option('display.precision', 2)       # \u5c0f\u6570\u7cbe\u5ea6\npd.reset_option('all')                      # \u91cd\u7f6e\u6240\u6709\u9009\u9879\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\u6027\u80fd\u4f18\u5316",children:"\u6027\u80fd\u4f18\u5316"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u4f7f\u7528\u5206\u7c7b\u7c7b\u578b\u8282\u7701\u5185\u5b58\ndf['B'] = df['B'].astype('category')\n\n# \u8bfb\u53d6\u5927\u6587\u4ef6\u65f6\u5206\u5757\nfor chunk in pd.read_csv('large_file.csv', chunksize=10000):\n    process(chunk)\n\n# \u4f7f\u7528 eval \u8fdb\u884c\u5411\u91cf\u5316\u8ba1\u7b97(\u66f4\u5feb)\ndf.eval('D = A + C', inplace=True)\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"-\u5e38\u89c1\u6570\u636e\u6e05\u6d17\u6d41\u7a0b",children:"\ud83d\udca1 \u5e38\u89c1\u6570\u636e\u6e05\u6d17\u6d41\u7a0b"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u5b8c\u6574\u7684\u6570\u636e\u6e05\u6d17\u793a\u4f8b\ndf = (df\n    .drop_duplicates()                          # \u5220\u9664\u91cd\u590d\n    .dropna(subset=['important_col'])           # \u5220\u9664\u5173\u952e\u5217\u7f3a\u5931\u503c\n    .fillna({'A': 0, 'B': 'unknown'})          # \u586b\u5145\u5176\u4ed6\u7f3a\u5931\u503c\n    .assign(                                     # \u6dfb\u52a0/\u4fee\u6539\u5217\n        D=lambda x: x['A'] * 2,\n        E=lambda x: x['B'].str.upper()\n    )\n    .query('A > 0')                             # \u7b5b\u9009\n    .reset_index(drop=True)                     # \u91cd\u7f6e\u7d22\u5f15\n)\n\n# \u673a\u5668\u5b66\u4e60\u9884\u5904\u7406\u6d41\u7a0b\n# 1. \u5206\u79bb\u6570\u503c\u548c\u7c7b\u522b\u7279\u5f81\nnumeric_features = df.select_dtypes(include=[np.number]).columns\ncategorical_features = df.select_dtypes(include=['object']).columns\n\n# 2. \u5904\u7406\u6570\u503c\u7279\u5f81\ndf[numeric_features] = df[numeric_features].fillna(df[numeric_features].median())\n\n# 3. \u5904\u7406\u7c7b\u522b\u7279\u5f81\u5e76\u7f16\u7801\ndf[categorical_features] = df[categorical_features].fillna('missing')\ndf_encoded = pd.get_dummies(df, columns=categorical_features, drop_first=True)\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"-\u5feb\u901f\u67e5\u627e\u548c\u7d22\u5f15",children:"\ud83d\udd0d \u5feb\u901f\u67e5\u627e\u548c\u7d22\u5f15"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u67e5\u627e\u7279\u5b9a\u503c\u7684\u4f4d\u7f6e\ndf[df['A'] == 5].index\n\n# \u6309\u6761\u4ef6\u83b7\u53d6\u7b2c\u4e00\u884c/\u6700\u540e\u4e00\u884c\ndf[df['A'] > 2].head(1)\ndf[df['A'] > 2].iloc[0]\n\n# \u91cd\u7f6e\u7d22\u5f15\ndf.reset_index(drop=True, inplace=True)\n\n# \u8bbe\u7f6e\u7d22\u5f15\ndf.set_index('A', inplace=True)\n\n# \u591a\u7ea7\u7d22\u5f15\ndf.set_index(['A', 'B'], inplace=True)\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"-\u5c0f\u6284\u901f\u67e5",children:"\ud83d\udcdd \u5c0f\u6284\u901f\u67e5"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \u6700\u5e38\u7528\u7684\u64cd\u4f5c\ndf.head()                       # \u67e5\u770b\u524d\u51e0\u884c\ndf.info()                       # \u6570\u636e\u6982\u89c8\ndf.describe()                   # \u7edf\u8ba1\u6458\u8981\ndf[df['col'] > 5]              # \u6761\u4ef6\u7b5b\u9009\ndf.groupby('col').mean()       # \u5206\u7ec4\u805a\u5408\ndf.sort_values('col')          # \u6392\u5e8f\ndf.dropna()                    # \u5220\u9664\u7f3a\u5931\u503c\ndf.fillna(0)                   # \u586b\u5145\u7f3a\u5931\u503c\npd.get_dummies(df)             # \u72ec\u70ed\u7f16\u7801(\u7c7b\u522b\u53d8\u91cf\u8f6c\u6570\u503c)\npd.merge(df1, df2, on='key')   # \u5408\u5e76\ndf.to_csv('file.csv')          # \u4fdd\u5b58\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u8fd9\u4efd\u901f\u67e5\u624b\u518c\u6db5\u76d6\u4e86 pandas 95% \u7684\u65e5\u5e38\u4f7f\u7528\u573a\u666f,\u5efa\u8bae\u6536\u85cf!"})," \ud83d\udcda"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.em,{children:"\u53c2\u8003\u8d44\u6e90:"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://pandas.pydata.org/docs/",children:"Pandas \u5b98\u65b9\u6587\u6863"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://pandas.pydata.org/Pandas_Cheat_Sheet.pdf",children:"Pandas Cheat Sheet"})}),"\n"]})]})}function f(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(o,{...n})}):o(n)}}}]);