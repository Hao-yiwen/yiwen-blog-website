"use strict";(globalThis.webpackChunkyiwen_blog_website=globalThis.webpackChunkyiwen_blog_website||[]).push([[60803],{12010(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>a,frontMatter:()=>t,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"backend/devops/observability-metrics-methodology","title":"\u53ef\u89c2\u6d4b\u6027\u6307\u6807\u4f53\u7cfb\u8bbe\u8ba1","description":"\u6784\u5efa\u4e00\u5957\u751f\u4ea7\u7ea7\u53ef\u89c2\u6d4b\u6027\u4f53\u7cfb\uff0c\u6838\u5fc3\u4e0d\u5728\u4e8e\\"\u6307\u6807\u8d8a\u591a\u8d8a\u597d\\"\uff0c\u800c\u5728\u4e8e\\"\u5206\u5c42\u76d1\u63a7\uff0c\u91cd\u70b9\u7a81\u51fa\\"\u3002","source":"@site/docs/backend/devops/observability-metrics-methodology.md","sourceDirName":"backend/devops","slug":"/backend/devops/observability-metrics-methodology","permalink":"/yiwen-blog-website/en/docs/backend/devops/observability-metrics-methodology","draft":false,"unlisted":false,"editUrl":"https://github.com/Hao-yiwen/yiwen-blog-website/tree/master/docs/backend/devops/observability-metrics-methodology.md","tags":[{"inline":true,"label":"observability","permalink":"/yiwen-blog-website/en/docs/tags/observability"},{"inline":true,"label":"metrics","permalink":"/yiwen-blog-website/en/docs/tags/metrics"},{"inline":true,"label":"sre","permalink":"/yiwen-blog-website/en/docs/tags/sre"},{"inline":true,"label":"red","permalink":"/yiwen-blog-website/en/docs/tags/red"},{"inline":true,"label":"use","permalink":"/yiwen-blog-website/en/docs/tags/use"},{"inline":true,"label":"grafana","permalink":"/yiwen-blog-website/en/docs/tags/grafana"},{"inline":true,"label":"alerting","permalink":"/yiwen-blog-website/en/docs/tags/alerting"},{"inline":true,"label":"prometheus","permalink":"/yiwen-blog-website/en/docs/tags/prometheus"}],"version":"current","lastUpdatedAt":1771944948000,"sidebarPosition":6,"frontMatter":{"title":"\u53ef\u89c2\u6d4b\u6027\u6307\u6807\u4f53\u7cfb\u8bbe\u8ba1","sidebar_position":6,"tags":["observability","metrics","sre","red","use","grafana","alerting","prometheus"]},"sidebar":"backendSidebar","previous":{"title":"OpenTelemetry \u53ef\u89c2\u6d4b\u6027\u5b9e\u8df5","permalink":"/yiwen-blog-website/en/docs/backend/devops/opentelemetry-observability"},"next":{"title":"\u524d\u7aef\u5168\u94fe\u8def\u76d1\u63a7\u65b9\u6848","permalink":"/yiwen-blog-website/en/docs/backend/devops/frontend-observability-sentry-posthog"}}');var i=s(74848),l=s(28453);const t={title:"\u53ef\u89c2\u6d4b\u6027\u6307\u6807\u4f53\u7cfb\u8bbe\u8ba1",sidebar_position:6,tags:["observability","metrics","sre","red","use","grafana","alerting","prometheus"]},d="\u751f\u4ea7\u7ea7\u53ef\u89c2\u6d4b\u6027\u6307\u6807\u4f53\u7cfb\u8bbe\u8ba1",c={},h=[{value:"\u7b2c\u4e00\u5c42\uff1a\u4e1a\u52a1\u5173\u952e\u6307\u6807 (Business Metrics)",id:"\u7b2c\u4e00\u5c42\u4e1a\u52a1\u5173\u952e\u6307\u6807-business-metrics",level:2},{value:"\u7b2c\u4e8c\u5c42\uff1a\u670d\u52a1\u8fd0\u884c\u6307\u6807 (Application Metrics)",id:"\u7b2c\u4e8c\u5c42\u670d\u52a1\u8fd0\u884c\u6307\u6807-application-metrics",level:2},{value:"RED \u65b9\u6cd5\u8bba\u56fe\u89e3",id:"red-\u65b9\u6cd5\u8bba\u56fe\u89e3",level:3},{value:"\u7b2c\u4e09\u5c42\uff1a\u4e2d\u95f4\u4ef6/\u4f9d\u8d56\u6307\u6807 (Middleware Metrics)",id:"\u7b2c\u4e09\u5c42\u4e2d\u95f4\u4ef6\u4f9d\u8d56\u6307\u6807-middleware-metrics",level:2},{value:"1. \u6570\u636e\u5e93 (MySQL/Postgres)",id:"1-\u6570\u636e\u5e93-mysqlpostgres",level:3},{value:"2. \u7f13\u5b58 (Redis)",id:"2-\u7f13\u5b58-redis",level:3},{value:"3. \u6d88\u606f\u961f\u5217 (Kafka/RocketMQ)",id:"3-\u6d88\u606f\u961f\u5217-kafkarocketmq",level:3},{value:"\u7b2c\u56db\u5c42\uff1a\u57fa\u7840\u8bbe\u65bd\u6307\u6807 (Infrastructure Metrics - K8s)",id:"\u7b2c\u56db\u5c42\u57fa\u7840\u8bbe\u65bd\u6307\u6807-infrastructure-metrics---k8s",level:2},{value:"USE \u65b9\u6cd5\u8bba\u56fe\u89e3",id:"use-\u65b9\u6cd5\u8bba\u56fe\u89e3",level:3},{value:"K8s \u6838\u5fc3\u6307\u6807",id:"k8s-\u6838\u5fc3\u6307\u6807",level:3},{value:"\u843d\u5730\u5b9e\u6218\uff1aGrafana \u5927\u76d8\u8bbe\u8ba1",id:"\u843d\u5730\u5b9e\u6218grafana-\u5927\u76d8\u8bbe\u8ba1",level:2},{value:"1. \u5168\u5c40\u6982\u89c8\u5927\u76d8 (Global Overview)",id:"1-\u5168\u5c40\u6982\u89c8\u5927\u76d8-global-overview",level:3},{value:"2. \u670d\u52a1\u8be6\u60c5\u5927\u76d8 (Service Detail)",id:"2-\u670d\u52a1\u8be6\u60c5\u5927\u76d8-service-detail",level:3},{value:"3. \u8d44\u6e90\u6392\u67e5\u5927\u76d8 (Pod/Node Level)",id:"3-\u8d44\u6e90\u6392\u67e5\u5927\u76d8-podnode-level",level:3},{value:"\u5fc5\u987b\u914d\u7f6e\u544a\u8b66\u7684 P0 \u7ea7\u6307\u6807",id:"\u5fc5\u987b\u914d\u7f6e\u544a\u8b66\u7684-p0-\u7ea7\u6307\u6807",level:2},{value:"\u544a\u8b66\u914d\u7f6e\u793a\u4f8b (Prometheus AlertManager)",id:"\u544a\u8b66\u914d\u7f6e\u793a\u4f8b-prometheus-alertmanager",level:2},{value:"\u603b\u7ed3\uff1a\u5206\u5c42\u76d1\u63a7\u67b6\u6784",id:"\u603b\u7ed3\u5206\u5c42\u76d1\u63a7\u67b6\u6784",level:2}];function o(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u751f\u4ea7\u7ea7\u53ef\u89c2\u6d4b\u6027\u6307\u6807\u4f53\u7cfb\u8bbe\u8ba1",children:"\u751f\u4ea7\u7ea7\u53ef\u89c2\u6d4b\u6027\u6307\u6807\u4f53\u7cfb\u8bbe\u8ba1"})}),"\n",(0,i.jsx)(n.p,{children:'\u6784\u5efa\u4e00\u5957\u751f\u4ea7\u7ea7\u53ef\u89c2\u6d4b\u6027\u4f53\u7cfb\uff0c\u6838\u5fc3\u4e0d\u5728\u4e8e"\u6307\u6807\u8d8a\u591a\u8d8a\u597d"\uff0c\u800c\u5728\u4e8e**"\u5206\u5c42\u76d1\u63a7\uff0c\u91cd\u70b9\u7a81\u51fa"**\u3002'}),"\n",(0,i.jsxs)(n.p,{children:["\u6839\u636e ",(0,i.jsx)(n.strong,{children:"Google SRE"})," \u63a8\u5d07\u7684 ",(0,i.jsx)(n.strong,{children:'"RED"'})," \u548c ",(0,i.jsx)(n.strong,{children:'"USE"'})," \u65b9\u6cd5\u8bba\uff0c\u51c6\u5907\u4ee5\u4e0b ",(0,i.jsx)(n.strong,{children:"4 \u4e2a\u5c42\u7ea7"})," \u7684\u6838\u5fc3\u6307\u6807\u3002\u8fd9\u5957\u6307\u6807\u4f53\u7cfb\u914d\u5408 Go-Zero + OpenTelemetry + K8s \u7b80\u76f4\u662f\u7edd\u914d\u3002"]}),"\n",(0,i.jsx)(n.h2,{id:"\u7b2c\u4e00\u5c42\u4e1a\u52a1\u5173\u952e\u6307\u6807-business-metrics",children:"\u7b2c\u4e00\u5c42\uff1a\u4e1a\u52a1\u5173\u952e\u6307\u6807 (Business Metrics)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u8fd9\u662f\u7ed9\u8001\u677f\u548c\u4ea7\u54c1\u7ecf\u7406\u770b\u7684\u3002"})," \u5982\u679c\u8fd9\u5c42\u6302\u4e86\uff0c\u6280\u672f\u6307\u6807\u518d\u597d\u770b\u90fd\u6ca1\u7528\u3002"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(n.th,{children:"\u542b\u4e49"}),(0,i.jsx)(n.th,{children:"\u4e3a\u4ec0\u4e48\u91cd\u8981"}),(0,i.jsx)(n.th,{children:"\u6570\u636e\u6765\u6e90"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u6838\u5fc3\u4e1a\u52a1\u91cf"})}),(0,i.jsx)(n.td,{children:"\u5982\uff1a\u6bcf\u5206\u949f\u4e0b\u5355\u6570\u3001\u652f\u4ed8\u6210\u529f\u6570\u3001\u77ed\u4fe1\u53d1\u9001\u6570"}),(0,i.jsx)(n.td,{children:'\u76f4\u89c2\u53cd\u6620\u4e1a\u52a1\u662f\u5426"\u6d3b\u7740"\u3002\u5982\u679c\u7a81\u7136\u5f52\u96f6\uff0c\u8fd9\u5c31\u662f\u6700\u9ad8\u7ea7(P0)\u4e8b\u6545'}),(0,i.jsx)(n.td,{children:"\u624b\u52a8\u57cb\u70b9 (OTel Metrics)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u4e1a\u52a1\u6210\u529f\u7387"})}),(0,i.jsx)(n.td,{children:"(\u6210\u529f\u8ba2\u5355 / \u603b\u8bf7\u6c42)"}),(0,i.jsx)(n.td,{children:"\u6392\u9664 HTTP 500\uff0c\u4e1a\u52a1\u903b\u8f91\u4e0a\u7684\u5931\u8d25\uff08\u5982\u4f59\u989d\u4e0d\u8db3\u3001\u5e93\u5b58\u4e0d\u8db3\uff09\u4e5f\u8981\u5173\u6ce8"}),(0,i.jsx)(n.td,{children:"\u624b\u52a8\u57cb\u70b9"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u4e1a\u52a1\u8f6c\u6362\u6f0f\u6597"})}),(0,i.jsx)(n.td,{children:"\u6d4f\u89c8 -> \u52a0\u8d2d -> \u4e0b\u5355 -> \u652f\u4ed8"}),(0,i.jsx)(n.td,{children:"\u76d1\u63a7\u6bcf\u4e00\u6b65\u7684\u6d41\u5931\u7387\u662f\u5426\u5f02\u5e38"}),(0,i.jsx)(n.td,{children:"\u524d\u7aef/\u540e\u7aef\u57cb\u70b9 (PostHog/Umami)"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"\u7b2c\u4e8c\u5c42\u670d\u52a1\u8fd0\u884c\u6307\u6807-application-metrics",children:"\u7b2c\u4e8c\u5c42\uff1a\u670d\u52a1\u8fd0\u884c\u6307\u6807 (Application Metrics)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u8fd9\u662f\u7ed9\u540e\u7aef\u5f00\u53d1\u770b\u7684\u3002"})," \u8fd9\u91cc\u9075\u5faa ",(0,i.jsx)(n.strong,{children:"RED \u65b9\u6cd5\u8bba"})," (Rate, Errors, Duration)\u3002"]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"Go-Zero \u6846\u67b6\u4f1a\u81ea\u52a8\u8f93\u51fa\u8fd9\u4e9b\u6307\u6807\uff0c\u4e0d\u7528\u4f60\u5199\u4ee3\u7801\u3002"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u6307\u6807\u7ef4\u5ea6"}),(0,i.jsx)(n.th,{children:"\u5177\u4f53\u6307\u6807"}),(0,i.jsx)(n.th,{children:"\u544a\u8b66\u9608\u503c\u5efa\u8bae (\u53c2\u8003)"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"R (Rate)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"QPS (Requests Per Second)"})}),(0,i.jsx)(n.td,{children:"\u73af\u6bd4\u7a81\u589e/\u7a81\u964d 50% \u544a\u8b66\uff08\u9632\u653b\u51fb\u6216\u4e0a\u6e38\u6545\u969c\uff09"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"E (Errors)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"HTTP 5xx \u6bd4\u4f8b"})}),(0,i.jsx)(n.td,{children:"> 1% \u544a\u8b66"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"RPC \u9519\u8bef\u7387"})}),(0,i.jsx)(n.td,{children:"> 0.5% \u544a\u8b66\uff08\u5fae\u670d\u52a1\u5185\u90e8\u8c03\u7528\u5931\u8d25\uff09"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"D (Duration)"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"P99 \u5ef6\u8fdf"})," (99%\u7684\u8bf7\u6c42\u6709\u591a\u5feb)"]}),(0,i.jsx)(n.td,{children:"> 500ms (\u6839\u636e\u4e1a\u52a1\u8c03\u6574)\u3002\u53ea\u770b\u5e73\u5747\u503c\u6ca1\u610f\u4e49\uff0c\u8981\u770b\u957f\u5c3e"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"P95 \u5ef6\u8fdf"})}),(0,i.jsx)(n.td,{children:"> 200ms"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Runtime"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Goroutine \u6570\u91cf"})}),(0,i.jsx)(n.td,{children:"\u5982\u679c\u6301\u7eed\u4e0a\u6da8\u4e0d\u964d\uff0c\u8bf4\u660e\u6709\u534f\u7a0b\u6cc4\u6f0f (Leak)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"GC Pauses (\u5783\u573e\u56de\u6536\u6682\u505c)"})}),(0,i.jsx)(n.td,{children:"\u5982\u679c GC > 100ms\uff0c\u8bf4\u660e\u5bf9\u8c61\u5206\u914d\u592a\u9891\u7e41\uff0c\u670d\u52a1\u4f1a\u5361\u987f"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"red-\u65b9\u6cd5\u8bba\u56fe\u89e3",children:"RED \u65b9\u6cd5\u8bba\u56fe\u89e3"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    RED \u65b9\u6cd5\u8bba                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  R (Rate)      \u2502  \u8bf7\u6c42\u901f\u7387 - \u6bcf\u79d2\u591a\u5c11\u8bf7\u6c42                     \u2502\n\u2502  E (Errors)    \u2502  \u9519\u8bef\u6570\u91cf - \u6bcf\u79d2\u591a\u5c11\u8bf7\u6c42\u5931\u8d25                  \u2502\n\u2502  D (Duration)  \u2502  \u8017\u65f6\u5206\u5e03 - \u8bf7\u6c42\u54cd\u5e94\u65f6\u95f4\u5206\u5e03                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u7b2c\u4e09\u5c42\u4e2d\u95f4\u4ef6\u4f9d\u8d56\u6307\u6807-middleware-metrics",children:"\u7b2c\u4e09\u5c42\uff1a\u4e2d\u95f4\u4ef6/\u4f9d\u8d56\u6307\u6807 (Middleware Metrics)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u8fd9\u662f\u7531\u8fd0\u7ef4/\u67b6\u6784\u5e08\u91cd\u70b9\u5173\u6ce8\u7684\u3002"})," \u5f88\u591a\u65f6\u5019\u670d\u52a1\u6162\uff0c\u662f\u56e0\u4e3a\u6570\u636e\u5e93\u6216 Redis \u6162\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"1-\u6570\u636e\u5e93-mysqlpostgres",children:"1. \u6570\u636e\u5e93 (MySQL/Postgres)"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u6307\u6807"}),(0,i.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u8fde\u63a5\u6c60\u4f7f\u7528\u7387"})}),(0,i.jsx)(n.td,{children:"\u5982\u679c\u8fde\u63a5\u6c60\uff08Connection Pool\uff09\u6ee1\u4e86\uff0c\u5e94\u7528\u4f1a\u76f4\u63a5\u62a5\u9519"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u6162\u67e5\u8be2\u6570\u91cf (Slow Queries)"})}),(0,i.jsx)(n.td,{children:"\u6bcf\u5206\u949f\u4ea7\u751f\u7684\u6162 SQL \u6761\u6570"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u4e3b\u4ece\u5ef6\u8fdf (Replication Lag)"})}),(0,i.jsx)(n.td,{children:"\u5199\u4e3b\u5e93\uff0c\u8bfb\u4ece\u5e93\uff0c\u5982\u679c\u5ef6\u8fdf\u5927\uff0c\u7528\u6237\u4f1a\u53d1\u73b0\u521a\u6539\u5b8c\u7684\u6570\u636e\u6ca1\u53d8"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"2-\u7f13\u5b58-redis",children:"2. \u7f13\u5b58 (Redis)"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u6307\u6807"}),(0,i.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u7f13\u5b58\u547d\u4e2d\u7387 (Hit Rate)"})}),(0,i.jsx)(n.td,{children:"\u5982\u679c\u4f4e\u4e8e 80%\uff0c\u8bf4\u660e\u7f13\u5b58\u7a7f\u900f\u4e86\uff0c\u538b\u529b\u5168\u7ed9\u5230\u4e86 DB"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u5185\u5b58\u4f7f\u7528\u7387"})}),(0,i.jsx)(n.td,{children:"Redis \u6ee1\u4e86\u4f1a\u6839\u636e\u7b56\u7565\u8e22\u4eba\uff08Evict\uff09\uff0c\u5bfc\u81f4\u6570\u636e\u4e22\u5931\u6216\u62a5\u9519"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u7f51\u7edc\u5e26\u5bbd"})}),(0,i.jsx)(n.td,{children:"Redis \u541e\u5410\u91cf\u6781\u9ad8\uff0c\u5bb9\u6613\u628a\u7f51\u5361\u6253\u6ee1"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"3-\u6d88\u606f\u961f\u5217-kafkarocketmq",children:"3. \u6d88\u606f\u961f\u5217 (Kafka/RocketMQ)"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u6307\u6807"}),(0,i.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Consumer Lag (\u6d88\u8d39\u79ef\u538b)"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"\u8fd9\u662f\u6700\u91cd\u8981\u7684\u6307\u6807"}),"\u3002\u751f\u4ea7\u592a\u5feb\uff0c\u6d88\u8d39\u592a\u6162\uff0c\u5bfc\u81f4\u6d88\u606f\u5806\u79ef\u3002\u5982\u679c Lag \u6301\u7eed\u589e\u52a0\uff0c\u8bf4\u660e\u6d88\u8d39\u8005\u5904\u7406\u4e0d\u8fc7\u6765\u4e86"]})]})})]}),"\n",(0,i.jsx)(n.h2,{id:"\u7b2c\u56db\u5c42\u57fa\u7840\u8bbe\u65bd\u6307\u6807-infrastructure-metrics---k8s",children:"\u7b2c\u56db\u5c42\uff1a\u57fa\u7840\u8bbe\u65bd\u6307\u6807 (Infrastructure Metrics - K8s)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u8fd9\u662f\u5e95\u5ea7\u3002"})," \u9075\u5faa ",(0,i.jsx)(n.strong,{children:"USE \u65b9\u6cd5\u8bba"})," (Utilization, Saturation, Errors)\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"use-\u65b9\u6cd5\u8bba\u56fe\u89e3",children:"USE \u65b9\u6cd5\u8bba\u56fe\u89e3"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    USE \u65b9\u6cd5\u8bba                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  U (Utilization)  \u2502  \u8d44\u6e90\u5229\u7528\u7387 - CPU/Memory \u4f7f\u7528\u767e\u5206\u6bd4       \u2502\n\u2502  S (Saturation)   \u2502  \u9971\u548c\u5ea6 - \u8d44\u6e90\u6392\u961f/\u7b49\u5f85\u60c5\u51b5               \u2502\n\u2502  E (Errors)       \u2502  \u9519\u8bef\u6570 - \u8d44\u6e90\u64cd\u4f5c\u5931\u8d25\u6b21\u6570                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(n.h3,{id:"k8s-\u6838\u5fc3\u6307\u6807",children:"K8s \u6838\u5fc3\u6307\u6807"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(n.th,{children:"\u542b\u4e49"}),(0,i.jsx)(n.th,{children:"\u81f4\u547d\u6027"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Pod OOM Killed"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u5185\u5b58\u6ea2\u51fa\u88ab\u6740"})}),(0,i.jsx)(n.td,{children:"\u2b50\u2b50\u2b50\u2b50\u2b50 (Pod \u4f1a\u65e0\u9650\u91cd\u542f\uff0c\u670d\u52a1\u6781\u4e0d\u7a33\u5b9a)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"CPU Throttling"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"CPU \u88ab\u9650\u6d41"})}),(0,i.jsx)(n.td,{children:"\u2b50\u2b50\u2b50 (K8s \u9650\u5236\u4e86\u4f60\u7684 CPU \u4f7f\u7528\uff0c\u5bfc\u81f4\u670d\u52a1\u53d8\u6162)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Node Disk Usage"})}),(0,i.jsx)(n.td,{children:"\u8282\u70b9\u78c1\u76d8\u7a7a\u95f4"}),(0,i.jsx)(n.td,{children:"\u2b50\u2b50\u2b50\u2b50 (\u78c1\u76d8\u6ee1\u4f1a\u5bfc\u81f4 Docker \u65e0\u6cd5\u5199\u65e5\u5fd7\uff0cPod \u9a71\u9010)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Network I/O"})}),(0,i.jsx)(n.td,{children:"\u8fdb\u51fa\u6d41\u91cf"}),(0,i.jsx)(n.td,{children:"\u2b50\u2b50 (\u9664\u4e86\u89c6\u9891/\u4e0b\u8f7d\u4e1a\u52a1\uff0c\u4e00\u822c\u4e0d\u4f1a\u628a\u5343\u5146\u7f51\u5361\u6253\u6ee1)"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"\u843d\u5730\u5b9e\u6218grafana-\u5927\u76d8\u8bbe\u8ba1",children:"\u843d\u5730\u5b9e\u6218\uff1aGrafana \u5927\u76d8\u8bbe\u8ba1"}),"\n",(0,i.jsxs)(n.p,{children:["\u4e0d\u8981\u628a\u51e0\u767e\u4e2a\u6307\u6807\u5806\u5728\u4e00\u8d77\u3002\u5efa\u8bae\u5efa\u7acb ",(0,i.jsx)(n.strong,{children:"3 \u4e2a\u5c42\u7ea7\u7684\u5927\u76d8 (Dashboard)"}),"\uff1a"]}),"\n",(0,i.jsx)(n.h3,{id:"1-\u5168\u5c40\u6982\u89c8\u5927\u76d8-global-overview",children:"1. \u5168\u5c40\u6982\u89c8\u5927\u76d8 (Global Overview)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u53d7\u4f17"}),": \u6280\u672f\u603b\u76d1 / On-call \u4eba\u5458"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5185\u5bb9"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5168\u7ad9\u6838\u5fc3\u4e1a\u52a1 QPS \u66f2\u7ebf"}),"\n",(0,i.jsx)(n.li,{children:"\u6838\u5fc3\u94fe\u8def\uff08\u5982\uff1a\u4e0b\u5355\u63a5\u53e3\uff09\u7684\u6210\u529f\u7387 & P99 \u5ef6\u8fdf"}),"\n",(0,i.jsx)(n.li,{children:"\u5f53\u524d\u544a\u8b66\u6570\u91cf\uff08\u7ea2\u7eff\u706f\u663e\u793a\uff09"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u4e00\u53e5\u8bdd"}),": ",(0,i.jsx)(n.em,{children:'"\u4e00\u773c\u770b\u51fa\u7cfb\u7edf\u6709\u6ca1\u6709\u5d29\u3002"'})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2-\u670d\u52a1\u8be6\u60c5\u5927\u76d8-service-detail",children:"2. \u670d\u52a1\u8be6\u60c5\u5927\u76d8 (Service Detail)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u53d7\u4f17"}),": \u5177\u4f53\u7684\u5fae\u670d\u52a1\u8d1f\u8d23\u4eba\uff08\u6bd4\u5982\u8ba2\u5355\u7ec4\u5f00\u53d1\uff09"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5185\u5bb9"}),": (Go-Zero \u81ea\u52a8\u751f\u6210\u7684\u90a3\u4e9b)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u8be5\u670d\u52a1\u7684 QPS, Error Rate, P99 Latency"}),"\n",(0,i.jsx)(n.li,{children:"\u8be5\u670d\u52a1\u7684 Goroutine \u6570\u91cf, Heap \u5185\u5b58"}),"\n",(0,i.jsx)(n.li,{children:"\u8be5\u670d\u52a1\u8c03\u7528\u7684 DB \u548c Redis \u7684\u8017\u65f6"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"3-\u8d44\u6e90\u6392\u67e5\u5927\u76d8-podnode-level",children:"3. \u8d44\u6e90\u6392\u67e5\u5927\u76d8 (Pod/Node Level)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u53d7\u4f17"}),": \u8fd0\u7ef4 / SRE"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5185\u5bb9"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5177\u4f53\u67d0\u4e2a Pod \u7684 CPU/Memory \u66f2\u7ebf"}),"\n",(0,i.jsx)(n.li,{children:"K8s \u8282\u70b9\u7684\u8d1f\u8f7d\u60c5\u51b5"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u5fc5\u987b\u914d\u7f6e\u544a\u8b66\u7684-p0-\u7ea7\u6307\u6807",children:"\u5fc5\u987b\u914d\u7f6e\u544a\u8b66\u7684 P0 \u7ea7\u6307\u6807"}),"\n",(0,i.jsxs)(n.p,{children:["\u5982\u679c\u4f60\u6ca1\u65f6\u95f4\u914d\u90a3\u4e48\u591a\uff0c",(0,i.jsx)(n.strong,{children:"\u5148\u628a\u4e0b\u9762\u8fd9 5 \u4e2a\u914d\u4e0a\u544a\u8b66"}),"\uff0c\u4eca\u665a\u5c31\u80fd\u7761\u4e2a\u5b89\u7a33\u89c9\uff1a"]}),"\n",(0,i.jsx)(n.admonition,{title:"\u5173\u952e\u544a\u8b66\u6e05\u5355",type:"danger",children:(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"HTTP/RPC \u9519\u8bef\u7387 > 5%"})," (\u670d\u52a1\u6302\u4e86)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"P99 \u5ef6\u8fdf > 2\u79d2"})," (\u670d\u52a1\u5361\u6b7b\u4e86)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Pod OOM Killed (Count > 0)"})," (\u5185\u5b58\u7206\u4e86)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Kafka Consumer Lag > 10000"})," (\u6d88\u606f\u5904\u7406\u4e0d\u8fc7\u6765\u4e86)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u6838\u5fc3\u4e1a\u52a1\u91cf(\u5982\u8ba2\u5355) \u8dcc\u96f6"})," (\u5373\u4f7f\u7cfb\u7edf\u6ca1\u62a5\u9519\uff0c\u4e1a\u52a1\u4e5f\u53ef\u80fd\u65ad\u4e86)"]}),"\n"]})}),"\n",(0,i.jsx)(n.h2,{id:"\u544a\u8b66\u914d\u7f6e\u793a\u4f8b-prometheus-alertmanager",children:"\u544a\u8b66\u914d\u7f6e\u793a\u4f8b (Prometheus AlertManager)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'groups:\n  - name: critical-alerts\n    rules:\n      # \u9519\u8bef\u7387\u544a\u8b66\n      - alert: HighErrorRate\n        expr: |\n          sum(rate(http_server_requests_total{status=~"5.."}[5m]))\n          / sum(rate(http_server_requests_total[5m])) > 0.05\n        for: 2m\n        labels:\n          severity: critical\n        annotations:\n          summary: "HTTP \u9519\u8bef\u7387\u8d85\u8fc7 5%"\n          description: "\u5f53\u524d\u9519\u8bef\u7387: {{ $value | humanizePercentage }}"\n\n      # P99 \u5ef6\u8fdf\u544a\u8b66\n      - alert: HighLatency\n        expr: |\n          histogram_quantile(0.99,\n            sum(rate(http_server_request_duration_seconds_bucket[5m])) by (le)\n          ) > 2\n        for: 5m\n        labels:\n          severity: warning\n        annotations:\n          summary: "P99 \u5ef6\u8fdf\u8d85\u8fc7 2 \u79d2"\n\n      # OOM \u544a\u8b66\n      - alert: PodOOMKilled\n        expr: |\n          kube_pod_container_status_last_terminated_reason{reason="OOMKilled"} > 0\n        for: 0m\n        labels:\n          severity: critical\n        annotations:\n          summary: "Pod {{ $labels.pod }} OOM Killed"\n\n      # Kafka \u6d88\u8d39\u79ef\u538b\n      - alert: KafkaConsumerLag\n        expr: kafka_consumer_lag > 10000\n        for: 5m\n        labels:\n          severity: warning\n        annotations:\n          summary: "Kafka \u6d88\u8d39\u79ef\u538b: {{ $value }}"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u603b\u7ed3\u5206\u5c42\u76d1\u63a7\u67b6\u6784",children:"\u603b\u7ed3\uff1a\u5206\u5c42\u76d1\u63a7\u67b6\u6784"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u7b2c\u4e00\u5c42: \u4e1a\u52a1\u6307\u6807                          \u2502\n\u2502            (\u6838\u5fc3\u4e1a\u52a1\u91cf\u3001\u6210\u529f\u7387\u3001\u8f6c\u6362\u6f0f\u6597)                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                    \u7b2c\u4e8c\u5c42: \u670d\u52a1\u6307\u6807 (RED)                    \u2502\n\u2502              (QPS\u3001\u9519\u8bef\u7387\u3001P99/P95\u5ef6\u8fdf)                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                    \u7b2c\u4e09\u5c42: \u4e2d\u95f4\u4ef6\u6307\u6807                         \u2502\n\u2502           (DB\u8fde\u63a5\u6c60\u3001Redis\u547d\u4e2d\u7387\u3001Kafka Lag)                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                    \u7b2c\u56db\u5c42: \u57fa\u7840\u8bbe\u65bd\u6307\u6807 (USE)                 \u2502\n\u2502              (OOM\u3001CPU Throttling\u3001\u78c1\u76d8)                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u8fd9\u5957\u6307\u6807\u4f53\u7cfb\u7684\u6838\u5fc3\u601d\u60f3\u662f\uff1a",(0,i.jsx)(n.strong,{children:"\u4ece\u4e1a\u52a1\u5230\u57fa\u7840\u8bbe\u65bd\uff0c\u81ea\u4e0a\u800c\u4e0b\u5206\u5c42\uff0c\u6bcf\u5c42\u90fd\u6709\u660e\u786e\u7684\u5173\u6ce8\u70b9\u548c\u8d23\u4efb\u4eba"}),"\u3002"]})]})}function a(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},28453(e,n,s){s.d(n,{R:()=>t,x:()=>d});var r=s(96540);const i={},l=r.createContext(i);function t(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);