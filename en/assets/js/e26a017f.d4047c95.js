"use strict";(globalThis.webpackChunkyiwen_blog_website=globalThis.webpackChunkyiwen_blog_website||[]).push([[72483],{28453(e,s,n){n.d(s,{R:()=>t,x:()=>c});var l=n(96540);const r={},i=l.createContext(r);function t(e){const s=l.useContext(i);return l.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),l.createElement(i.Provider,{value:s},e.children)}},32420(e,s,n){n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>c,default:()=>x,frontMatter:()=>t,metadata:()=>l,toc:()=>h});const l=JSON.parse('{"id":"backend/architecture/hybrid-rag-rerank","title":"\u5de5\u4e1a\u7ea7 RAG \u67b6\u6784\u8bbe\u8ba1","description":"\u672c\u6587\u8be6\u7ec6\u8bf4\u660e\u5de5\u4e1a\u754c\u4e3b\u6d41\u7684 RAG \u67b6\u6784\u8bbe\u8ba1\u601d\u8def\uff0c\u6452\u5f03\u7b80\u5355\u7684 naive RAG\uff0c\u91c7\u7528 \u6df7\u5408\u68c0\u7d22 (Hybrid Search) + \u91cd\u6392\u5e8f (Re-rank) \u67b6\u6784\uff0c\u786e\u4fdd\u68c0\u7d22\u7684\u9ad8\u51c6\u786e\u7387\u548c\u9ad8\u53ec\u56de\u7387\u3002","source":"@site/docs/backend/architecture/hybrid-rag-rerank.md","sourceDirName":"backend/architecture","slug":"/backend/architecture/hybrid-rag-rerank","permalink":"/yiwen-blog-website/en/docs/backend/architecture/hybrid-rag-rerank","draft":false,"unlisted":false,"editUrl":"https://github.com/Hao-yiwen/yiwen-blog-website/tree/master/docs/backend/architecture/hybrid-rag-rerank.md","tags":[{"inline":true,"label":"AI","permalink":"/yiwen-blog-website/en/docs/tags/ai"},{"inline":true,"label":"RAG","permalink":"/yiwen-blog-website/en/docs/tags/rag"},{"inline":true,"label":"LLM","permalink":"/yiwen-blog-website/en/docs/tags/llm"},{"inline":true,"label":"\u68c0\u7d22\u7cfb\u7edf","permalink":"/yiwen-blog-website/en/docs/tags/\u68c0\u7d22\u7cfb\u7edf"}],"version":"current","lastUpdatedAt":1771999934000,"sidebarPosition":3,"frontMatter":{"title":"\u5de5\u4e1a\u7ea7 RAG \u67b6\u6784\u8bbe\u8ba1","sidebar_position":3,"tags":["AI","RAG","LLM","\u68c0\u7d22\u7cfb\u7edf"]},"sidebar":"backendSidebar","previous":{"title":"\u67b6\u6784\u8bbe\u8ba1","permalink":"/yiwen-blog-website/en/docs/category/\u67b6\u6784\u8bbe\u8ba1"},"next":{"title":"Monorepo \u4e0e\u5185\u90e8\u5f00\u6e90","permalink":"/yiwen-blog-website/en/docs/backend/architecture/Advanced_Architecture_Monorepo"}}');var r=n(74848),i=n(28453);const t={title:"\u5de5\u4e1a\u7ea7 RAG \u67b6\u6784\u8bbe\u8ba1",sidebar_position:3,tags:["AI","RAG","LLM","\u68c0\u7d22\u7cfb\u7edf"]},c="\u5de5\u4e1a\u7ea7 RAG \u67b6\u6784\u8bbe\u8ba1\uff1a\u6df7\u5408\u68c0\u7d22 + RRF + Rerank",d={},h=[{value:"1. \u6838\u5fc3\u67b6\u6784\u6982\u89c8",id:"1-\u6838\u5fc3\u67b6\u6784\u6982\u89c8",level:2},{value:"2. \u8be6\u7ec6\u5b9e\u73b0\u903b\u8f91",id:"2-\u8be6\u7ec6\u5b9e\u73b0\u903b\u8f91",level:2},{value:"\u9636\u6bb5\u4e00\uff1a\u7d22\u5f15\u6784\u5efa (Indexing)",id:"\u9636\u6bb5\u4e00\u7d22\u5f15\u6784\u5efa-indexing",level:3},{value:"\u9636\u6bb5\u4e8c\uff1a\u6df7\u5408\u68c0\u7d22 (Hybrid Retrieval)",id:"\u9636\u6bb5\u4e8c\u6df7\u5408\u68c0\u7d22-hybrid-retrieval",level:3},{value:"2.1 BM25 \u539f\u7406\u4e0e\u5b58\u50a8",id:"21-bm25-\u539f\u7406\u4e0e\u5b58\u50a8",level:4},{value:"2.2 \u591a\u8def\u53ec\u56de (Multi-path Retrieval)",id:"22-\u591a\u8def\u53ec\u56de-multi-path-retrieval",level:4},{value:"2.3 RRF \u539f\u7406\u8be6\u89e3 (Reciprocal Rank Fusion)",id:"23-rrf-\u539f\u7406\u8be6\u89e3-reciprocal-rank-fusion",level:4},{value:"2.4 Cross-Encoder \u91cd\u6392\u5e8f\u539f\u7406 (Re-ranking)",id:"24-cross-encoder-\u91cd\u6392\u5e8f\u539f\u7406-re-ranking",level:4},{value:"3. \u5173\u952e\u914d\u7f6e\u53c2\u6570",id:"3-\u5173\u952e\u914d\u7f6e\u53c2\u6570",level:2},{value:"4. \u4e3a\u4ec0\u4e48\u8fd9\u6837\u8bbe\u8ba1\uff1f",id:"4-\u4e3a\u4ec0\u4e48\u8fd9\u6837\u8bbe\u8ba1",level:2},{value:"5. \u5173\u952e\u6587\u6863\u5904\u7406\u7b56\u7565\uff1a\u5206\u8bcd\u4e0e\u5207\u5206",id:"5-\u5173\u952e\u6587\u6863\u5904\u7406\u7b56\u7565\u5206\u8bcd\u4e0e\u5207\u5206",level:2},{value:"5.1 \u9012\u5f52\u5207\u5206\u903b\u8f91 (<code>RecursiveCharacterTextSplitter</code>)",id:"51-\u9012\u5f52\u5207\u5206\u903b\u8f91-recursivecharactertextsplitter",level:3},{value:"5.2 \u53c2\u6570\u914d\u7f6e",id:"52-\u53c2\u6570\u914d\u7f6e",level:3},{value:"5.3 \u5143\u6570\u636e\u7ee7\u627f",id:"53-\u5143\u6570\u636e\u7ee7\u627f",level:3},{value:"6. \u751f\u4ea7\u73af\u5883\u5347\u7ea7\u6307\u5357\uff1aElasticSearch \u5b9e\u73b0 BM25",id:"6-\u751f\u4ea7\u73af\u5883\u5347\u7ea7\u6307\u5357elasticsearch-\u5b9e\u73b0-bm25",level:2},{value:"6.1 \u4e3a\u4ec0\u4e48\u9009 ES\uff1f",id:"61-\u4e3a\u4ec0\u4e48\u9009-es",level:3},{value:"6.2 \u5206\u8bcd\u5668\u9009\u62e9 (Analyzer)",id:"62-\u5206\u8bcd\u5668\u9009\u62e9-analyzer",level:3},{value:"6.3 ES \u7d22\u5f15 Mapping \u793a\u4f8b",id:"63-es-\u7d22\u5f15-mapping-\u793a\u4f8b",level:3},{value:"7. \u603b\u7ed3",id:"7-\u603b\u7ed3",level:2}];function a(e){const s={annotation:"annotation",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",math:"math",mermaid:"mermaid",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",munder:"munder",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"\u5de5\u4e1a\u7ea7-rag-\u67b6\u6784\u8bbe\u8ba1\u6df7\u5408\u68c0\u7d22--rrf--rerank",children:"\u5de5\u4e1a\u7ea7 RAG \u67b6\u6784\u8bbe\u8ba1\uff1a\u6df7\u5408\u68c0\u7d22 + RRF + Rerank"})}),"\n",(0,r.jsxs)(s.p,{children:["\u672c\u6587\u8be6\u7ec6\u8bf4\u660e\u5de5\u4e1a\u754c\u4e3b\u6d41\u7684 RAG \u67b6\u6784\u8bbe\u8ba1\u601d\u8def\uff0c\u6452\u5f03\u7b80\u5355\u7684 naive RAG\uff0c\u91c7\u7528 ",(0,r.jsx)(s.strong,{children:"\u6df7\u5408\u68c0\u7d22 (Hybrid Search)"})," + ",(0,r.jsx)(s.strong,{children:"\u91cd\u6392\u5e8f (Re-rank)"})," \u67b6\u6784\uff0c\u786e\u4fdd\u68c0\u7d22\u7684\u9ad8\u51c6\u786e\u7387\u548c\u9ad8\u53ec\u56de\u7387\u3002"]}),"\n",(0,r.jsx)(s.h2,{id:"1-\u6838\u5fc3\u67b6\u6784\u6982\u89c8",children:"1. \u6838\u5fc3\u67b6\u6784\u6982\u89c8"}),"\n",(0,r.jsx)(s.p,{children:"RAG \u7cfb\u7edf\u4e3b\u8981\u7531\u4ee5\u4e0b\u6838\u5fc3\u7ec4\u4ef6\u6784\u6210\uff1a"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Embedding \u6a21\u578b"}),": \u8c46\u5305 (Doubao-Embedding-Vision)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u5411\u91cf\u6570\u636e\u5e93"}),": ChromaDB"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u7d22\u5f15\u7ba1\u7406"}),": LlamaIndex Framework"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u68c0\u7d22\u7b56\u7565"}),":","\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u591a\u8def\u53ec\u56de"}),": \u540c\u65f6\u8fdb\u884c ",(0,r.jsx)(s.strong,{children:"\u5411\u91cf\u68c0\u7d22 (Vector)"})," \u548c ",(0,r.jsx)(s.strong,{children:"\u5173\u952e\u8bcd\u68c0\u7d22 (BM25)"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u7ed3\u679c\u878d\u5408"}),": \u4f7f\u7528 ",(0,r.jsx)(s.strong,{children:"RRF (Reciprocal Rank Fusion)"})," \u7b97\u6cd5\u5408\u5e76\u4e24\u8def\u7ed3\u679c"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u7cbe\u7ec6\u6392\u5e8f"}),": \u4f7f\u7528\u672c\u5730 ",(0,r.jsx)(s.strong,{children:"Cross-Encoder"})," \u6a21\u578b\u8fdb\u884c\u8bed\u4e49\u91cd\u6392\u5e8f"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"\u6d41\u7a0b\u56fe\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(s.mermaid,{value:'graph TD\n    subgraph Indexing ["\u7d22\u5f15\u6784\u5efa\u9636\u6bb5"]\n        Doc[\u539f\u59cb\u6587\u6863] --\x3e Node[TextNode \u5207\u5206]\n        Node --\x3e |Embedded by Doubao| Vector[ChromaDB - Vector Store]\n        Node --\x3e BM25[DocStore - BM25 Index]\n    end\n\n    subgraph Retrieval ["\u6df7\u5408\u68c0\u7d22\u9636\u6bb5 - Hybrid Retriever"]\n        Query[\u7528\u6237 Query] --\x3e |\u5e76\u884c\u6267\u884c| VecSearch[\u5411\u91cf\u68c0\u7d22]\n        Query --\x3e |\u5e76\u884c\u6267\u884c| KwSearch[BM25 \u5173\u952e\u8bcd\u68c0\u7d22]\n\n        VecSearch --\x3e |Top-K Results| Fusion[RRF \u878d\u5408\u7b97\u6cd5]\n        KwSearch --\x3e |Top-K Results| Fusion\n\n        Fusion --\x3e |Merged Candidates| Rerank[Cross-Encoder \u91cd\u6392\u5e8f]\n        Rerank --\x3e |Final Top-N| LLM[LLM \u751f\u6210]\n    end'}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"2-\u8be6\u7ec6\u5b9e\u73b0\u903b\u8f91",children:"2. \u8be6\u7ec6\u5b9e\u73b0\u903b\u8f91"}),"\n",(0,r.jsx)(s.h3,{id:"\u9636\u6bb5\u4e00\u7d22\u5f15\u6784\u5efa-indexing",children:"\u9636\u6bb5\u4e00\uff1a\u7d22\u5f15\u6784\u5efa (Indexing)"}),"\n",(0,r.jsxs)(s.p,{children:["\u4f7f\u7528 ",(0,r.jsx)(s.code,{children:"LlamaIndexManager"})," \u6765\u7edf\u4e00\u7ba1\u7406\u7d22\u5f15\u751f\u547d\u5468\u671f\u3002"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u6587\u6863\u5904\u7406"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\u5c06 ",(0,r.jsx)(s.code,{children:"Document"})," \u5bf9\u8c61\u8f6c\u6362\u4e3a LlamaIndex \u7684 ",(0,r.jsx)(s.code,{children:"TextNode"})]}),"\n",(0,r.jsx)(s.li,{children:"\u7ee7\u627f\u5143\u6570\u636e\uff08source, title \u7b49\uff09"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u53cc\u91cd\u5b58\u50a8"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Vector Store"}),": \u8282\u70b9\u6587\u672c\u88ab\u53d1\u9001\u7ed9 ",(0,r.jsx)(s.code,{children:"DoubaoEmbedding"})," \u6a21\u578b\u751f\u6210\u5411\u91cf\uff0c\u5b58\u5165 ",(0,r.jsx)(s.strong,{children:"ChromaDB"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"DocStore"}),": \u539f\u59cb\u8282\u70b9\u3001\u6587\u672c\u548c\u5173\u7cfb\u88ab\u5b58\u5165 ",(0,r.jsx)(s.code,{children:"SimpleDocumentStore"})," (JSON\u6587\u4ef6)\uff0c\u7528\u4e8e BM25 \u7d22\u5f15\u6784\u5efa"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"\u9636\u6bb5\u4e8c\u6df7\u5408\u68c0\u7d22-hybrid-retrieval",children:"\u9636\u6bb5\u4e8c\uff1a\u6df7\u5408\u68c0\u7d22 (Hybrid Retrieval)"}),"\n",(0,r.jsxs)(s.p,{children:["\u8fd9\u662f\u6838\u5fc3\u903b\u8f91\uff0c\u7531 ",(0,r.jsx)(s.code,{children:"HybridRetriever"})," \u7c7b\u5b9e\u73b0\u3002"]}),"\n",(0,r.jsx)(s.h4,{id:"21-bm25-\u539f\u7406\u4e0e\u5b58\u50a8",children:"2.1 BM25 \u539f\u7406\u4e0e\u5b58\u50a8"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u6838\u5fc3\u539f\u7406"}),": BM25 (Best Match 25) \u662f\u4e00\u79cd\u57fa\u4e8e\u6982\u7387\u7684\u68c0\u7d22\u6a21\u578b\uff0c\u662f\u5bf9 TF-IDF \u7684\u6539\u8fdb\u3002"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"TF (Term Frequency)"}),": \u8bcd\u9891\u3002\u8bcd\u51fa\u73b0\u7684\u6b21\u6570\u8d8a\u591a\uff0c\u8d8a\u76f8\u5173\u3002BM25 \u5bf9\u6b64\u505a\u4e86\u9971\u548c\u5904\u7406\uff08k1 \u53c2\u6570\uff09\uff0c\u5373\u8bcd\u9891\u589e\u52a0\u5230\u4e00\u5b9a\u7a0b\u5ea6\u540e\uff0c\u5f97\u5206\u589e\u957f\u53d8\u7f13"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"IDF (Inverse Document Frequency)"}),': \u9006\u6587\u6863\u9891\u7387\u3002\u5982\u679c\u4e00\u4e2a\u8bcd\uff08\u5982"\u7684"\uff09\u5728\u6240\u6709\u6587\u6863\u90fd\u51fa\u73b0\uff0c\u5b83\u7684\u6743\u91cd\u5c31\u4f4e\uff1b\u53cd\u4e4b\uff08\u5982"Langfuse"\uff09\u8d8a\u7a00\u6709\uff0c\u6743\u91cd\u8d8a\u9ad8']}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Document Length Normalization"}),": \u6587\u6863\u957f\u5ea6\u5f52\u4e00\u5316\u3002\u77ed\u6587\u6863\u4e2d\u51fa\u73b0\u4e00\u6b21\u5173\u952e\u8bcd\uff0c\u6bd4\u957f\u6587\u6863\u4e2d\u51fa\u73b0\u4e00\u6b21\u66f4\u6709\u5206\u91cf\u3002BM25 \u4f1a\u60e9\u7f5a\u8fc7\u957f\u7684\u6587\u6863\uff08b \u53c2\u6570\uff09"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u5b58\u50a8\u7ed3\u6784 (\u5012\u6392\u7d22\u5f15)"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["BM25 \u4e0d\u5b58\u50a8\u5411\u91cf\uff0c\u800c\u662f\u6784\u5efa",(0,r.jsx)(s.strong,{children:"\u5012\u6392\u7d22\u5f15 (Inverted Index)"})]}),"\n",(0,r.jsxs)(s.li,{children:["\u7ed3\u6784\u7c7b\u4f3c\u5b57\u5178\uff1a",(0,r.jsx)(s.code,{children:'{ "Langfuse": [Doc1, Doc3], "\u914d\u7f6e": [Doc2, Doc3] }'})]}),"\n",(0,r.jsxs)(s.li,{children:["BM25 \u7d22\u5f15\u662f\u57fa\u4e8e ",(0,r.jsx)(s.code,{children:"SimpleDocumentStore"})," \u5728",(0,r.jsx)(s.strong,{children:"\u5185\u5b58\u4e2d"}),"\u6784\u5efa\u7684\uff0c\u6bcf\u6b21\u670d\u52a1\u542f\u52a8\u65f6\u4f1a\u91cd\u65b0\u8ba1\u7b97\u7edf\u8ba1\u4fe1\u606f\uff08TF/IDF\uff09\u4ee5\u6784\u5efa\u5012\u6392\u8868"]}),"\n"]}),"\n",(0,r.jsx)(s.h4,{id:"22-\u591a\u8def\u53ec\u56de-multi-path-retrieval",children:"2.2 \u591a\u8def\u53ec\u56de (Multi-path Retrieval)"}),"\n",(0,r.jsx)(s.p,{children:"\u9488\u5bf9\u540c\u4e00\u4e2a Query\uff0c\u7cfb\u7edf\u5e76\u884c\u6267\u884c\u4e24\u79cd\u68c0\u7d22\uff1a"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{style:{textAlign:"left"},children:"\u68c0\u7d22\u65b9\u5f0f"}),(0,r.jsx)(s.th,{style:{textAlign:"left"},children:"\u64c5\u957f\u573a\u666f"}),(0,r.jsx)(s.th,{style:{textAlign:"left"},children:"\u793a\u4f8b"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.strong,{children:"Vector Search"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"\u6355\u6349\u8bed\u4e49\u76f8\u5173\u6027\uff0c\u6982\u5ff5\u6027\u3001\u63cf\u8ff0\u6027\u95ee\u9898"}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:'"\u4ec0\u4e48\u662f RAG\uff1f"'})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.strong,{children:"BM25 Search"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"\u6355\u6349\u5173\u952e\u8bcd\u7cbe\u786e\u5339\u914d\uff0c\u4e13\u6709\u540d\u8bcd\u3001\u7279\u5b9a ID"}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:'"\u9519\u8bef\u7801 502 \u600e\u4e48\u529e\uff1f"'})]})]})]}),"\n",(0,r.jsx)(s.h4,{id:"23-rrf-\u539f\u7406\u8be6\u89e3-reciprocal-rank-fusion",children:"2.3 RRF \u539f\u7406\u8be6\u89e3 (Reciprocal Rank Fusion)"}),"\n",(0,r.jsx)(s.p,{children:"RRF \u662f\u4e00\u79cd\u4e3b\u8981\u57fa\u4e8e\u6392\u540d\u7684\u878d\u5408\u7b97\u6cd5\uff0c\u5b83\u4e0d\u4f9d\u8d56\u4e8e\u5206\u6570\u7684\u5177\u4f53\u6570\u503c\uff0c\u800c\u662f\u4f9d\u8d56\u4e8e\u6392\u540d\u7684\u76f8\u5bf9\u987a\u5e8f\u3002"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u6838\u5fc3\u75db\u70b9"}),": Vector \u7684\u5206\u6570\uff08\u5982 0.85\uff09\u548c BM25 \u7684\u5206\u6570\uff08\u5982 12.5\uff09\u4e0d\u5728\u4e00\u4e2a\u91cf\u7ea7\uff0c\u65e0\u6cd5\u76f4\u63a5\u52a0\u6743\u76f8\u52a0\u3002"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u7b97\u6cd5\u903b\u8f91"}),":"]}),"\n",(0,r.jsx)(s.span,{className:"katex-display",children:(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"S"}),(0,r.jsx)(s.mi,{children:"c"}),(0,r.jsx)(s.mi,{children:"o"}),(0,r.jsx)(s.mi,{children:"r"}),(0,r.jsx)(s.mi,{children:"e"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsx)(s.mi,{children:"d"}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"}),(0,r.jsx)(s.mo,{children:"="}),(0,r.jsxs)(s.munder,{children:[(0,r.jsx)(s.mo,{children:"\u2211"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"r"}),(0,r.jsx)(s.mo,{children:"\u2208"}),(0,r.jsx)(s.mi,{children:"R"})]})]}),(0,r.jsxs)(s.mfrac,{children:[(0,r.jsx)(s.mn,{children:"1"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"k"}),(0,r.jsx)(s.mo,{children:"+"}),(0,r.jsx)(s.mi,{children:"r"}),(0,r.jsx)(s.mi,{children:"a"}),(0,r.jsx)(s.mi,{children:"n"}),(0,r.jsx)(s.mi,{children:"k"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsx)(s.mi,{children:"d"}),(0,r.jsx)(s.mo,{separator:"true",children:","}),(0,r.jsx)(s.mi,{children:"r"}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"})]})]})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"Score(d) = \\sum_{r \\in R} \\frac{1}{k + rank(d, r)}"})]})})}),(0,r.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"core"}),(0,r.jsx)(s.span,{className:"mopen",children:"("}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,r.jsx)(s.span,{className:"mclose",children:")"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.jsx)(s.span,{className:"mrel",children:"="}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"2.6431em",verticalAlign:"-1.3217em"}}),(0,r.jsx)(s.span,{className:"mop op-limits",children:(0,r.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,r.jsxs)(s.span,{className:"vlist-r",children:[(0,r.jsxs)(s.span,{className:"vlist",style:{height:"1.05em"},children:[(0,r.jsxs)(s.span,{style:{top:"-1.8557em",marginLeft:"0em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"3.05em"}}),(0,r.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,r.jsxs)(s.span,{className:"mord mtight",children:[(0,r.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"r"}),(0,r.jsx)(s.span,{className:"mrel mtight",children:"\u2208"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.00773em"},children:"R"})]})})]}),(0,r.jsxs)(s.span,{style:{top:"-3.05em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"3.05em"}}),(0,r.jsx)(s.span,{children:(0,r.jsx)(s.span,{className:"mop op-symbol large-op",children:"\u2211"})})]})]}),(0,r.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,r.jsx)(s.span,{className:"vlist-r",children:(0,r.jsx)(s.span,{className:"vlist",style:{height:"1.3217em"},children:(0,r.jsx)(s.span,{})})})]})}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,r.jsx)(s.span,{className:"mfrac",children:(0,r.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,r.jsxs)(s.span,{className:"vlist-r",children:[(0,r.jsxs)(s.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,r.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.jsx)(s.span,{className:"mbin",children:"+"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"ank"}),(0,r.jsx)(s.span,{className:"mopen",children:"("}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,r.jsx)(s.span,{className:"mpunct",children:","}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,r.jsx)(s.span,{className:"mclose",children:")"})]})]}),(0,r.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,r.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsx)(s.span,{className:"mord",children:(0,r.jsx)(s.span,{className:"mord",children:"1"})})]})]}),(0,r.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,r.jsx)(s.span,{className:"vlist-r",children:(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.936em"},children:(0,r.jsx)(s.span,{})})})]})}),(0,r.jsx)(s.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u5012\u6570\u52a0\u548c"}),": \u6392\u540d\u8d8a\u9760\u524d\uff08Rank \u8d8a\u5c0f\uff09\uff0c\u5206\u6bcd\u8d8a\u5c0f\uff0c\u5f97\u5206\u8d8a\u9ad8"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u5e73\u6ed1\u5e38\u6570 k"}),": \u901a\u5e38\u53d6 60\u3002\u5b83\u7684\u4f5c\u7528\u662f\u51cf\u7f13\u5934\u51e0\u540d\u4e4b\u95f4\u7684\u5dee\u8ddd\uff0c\u9632\u6b62\u67d0\u4e2a\u6587\u6863\u4ec5\u56e0\u4e3a\u5728\u67d0\u4e00\u8def\u6392\u7b2c\u4e00\u5c31\u76f4\u63a5\u7edf\u6cbb\u603b\u699c"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u4f18\u52bf"}),': \u9c81\u68d2\u6027\u6781\u5f3a\u3002\u5b83\u80fd\u6709\u6548\u7b5b\u9009\u51fa\u5728\u4e24\u8def\u53ec\u56de\u4e2d\u90fd\u8868\u73b0\u4e0d\u9519\u7684"\u7a33\u5065\u578b"\u6587\u6863\u3002']}),"\n",(0,r.jsx)(s.h4,{id:"24-cross-encoder-\u91cd\u6392\u5e8f\u539f\u7406-re-ranking",children:"2.4 Cross-Encoder \u91cd\u6392\u5e8f\u539f\u7406 (Re-ranking)"}),"\n",(0,r.jsx)(s.p,{children:"\u8fd9\u662f RAG \u6d41\u7a0b\u4e2d\u63d0\u5347\u7cbe\u5ea6\u7684\u5173\u952e\u4e00\u6b65\uff0c\u4f7f\u7528\u7684\u662f\u57fa\u4e8e Transformer \u7684 Cross-Encoder \u67b6\u6784\u3002"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Bi-Encoder VS Cross-Encoder"}),":"]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{style:{textAlign:"left"},children:"\u6a21\u578b"}),(0,r.jsx)(s.th,{style:{textAlign:"left"},children:"\u8ba1\u7b97\u65b9\u5f0f"}),(0,r.jsx)(s.th,{style:{textAlign:"left"},children:"\u4f18\u70b9"}),(0,r.jsx)(s.th,{style:{textAlign:"left"},children:"\u7f3a\u70b9"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.strong,{children:"Bi-Encoder (\u53cc\u5854)"})}),(0,r.jsxs)(s.td,{style:{textAlign:"left"},children:["Query \u548c Document ",(0,r.jsx)(s.strong,{children:"\u5206\u522b"}),"\u72ec\u7acb\u8ba1\u7b97\u5411\u91cf"]}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"\u5feb\uff08\u53ef\u9884\u5148\u7d22\u5f15\uff09"}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"\u4e22\u5931\u6df1\u5ea6\u4ea4\u4e92\u4fe1\u606f"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.strong,{children:"Cross-Encoder (\u5355\u5854)"})}),(0,r.jsxs)(s.td,{style:{textAlign:"left"},children:[(0,r.jsx)(s.code,{children:"[CLS] Query [SEP] Document [SEP]"})," \u62fc\u63a5\u540e\u9001\u5165 BERT"]}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"\u5168\u5458\u4ea4\u4e92\uff0c\u7cbe\u5ea6\u9ad8"}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"\u6162\uff0c\u9700\u5b9e\u65f6\u63a8\u7406"})]})]})]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u6ce8\u610f\u529b\u673a\u5236 (Self-Attention)"}),":"]}),"\n",(0,r.jsxs)(s.p,{children:["\u5728 Transformer \u5185\u90e8\uff0cQuery \u4e2d\u7684\u6bcf\u4e2a token \u90fd\u80fd\u4e0e Document \u4e2d\u7684\u6bcf\u4e2a token \u8fdb\u884c",(0,r.jsx)(s.strong,{children:"\u5168\u5458\u4ea4\u4e92 (Full Self-Attention)"}),'\u3002\u8fd9\u610f\u5473\u7740\u6a21\u578b\u53ef\u4ee5"\u770b\u5230"\u5177\u4f53\u7684\u7ec6\u8282\u5339\u914d\u3002\u4f8b\u5982\uff1aQuery \u91cc\u7684"\u4e0d"\u5b57\u53ef\u4ee5\u76f4\u63a5\u5f71\u54cd Document \u91cc\u5bf9\u5e94\u52a8\u8bcd\u7684\u6743\u91cd\u3002']}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u8f93\u51fa"}),": \u6700\u7ec8\u53d6 ",(0,r.jsx)(s.code,{children:"[CLS]"})," \u4f4d\u7f6e\u7684\u5411\u91cf\u8f93\u51fa\uff0c\u7ecf\u8fc7\u4e00\u4e2a\u5206\u7c7b\u5c42 (Linear Layer)\uff0c\u76f4\u63a5\u8f93\u51fa\u4e00\u4e2a 0~1 \u4e4b\u95f4\u7684\u76f8\u5173\u6027\u6982\u7387\u3002"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u4ee3\u4ef7\u4e0e\u6743\u8861"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"\u56e0\u4e3a\u8981\u5b9e\u65f6\u5bf9\u6bcf\u4e00\u5bf9 (Query + Doc) \u8fdb\u884c\u7e41\u91cd\u7684 Transformer \u63a8\u7406\uff0c\u901f\u5ea6\u6162"}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u7b56\u7565"}),": \u53ea\u5bf9 RRF \u7b5b\u9009\u51fa\u7684 Top-20 \u6587\u6863\u8fdb\u884c Cross-Encoder \u91cd\u6392\uff0c\u4ece\u4e2d\u9009\u51fa Top-4\u3002\u8fd9\u662f\u7cbe\u5ea6\u4e0e\u901f\u5ea6\u7684\u6700\u4f73\u5e73\u8861\u70b9"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u63a8\u8350\u6a21\u578b"}),": ",(0,r.jsx)(s.code,{children:"ms-marco-MiniLM-L-6-v2"}),'\uff0c\u4e13\u95e8\u5728 MS MARCO \u6570\u636e\u96c6\uff08\u767e\u4e07\u7ea7\u95ee\u7b54\u6570\u636e\uff09\u4e0a\u5fae\u8c03\uff0c\u64c5\u957f\u5224\u65ad"\u8fd9\u4e2a\u95ee\u9898\u662f\u4e0d\u662f\u7531\u8fd9\u4e2a\u6bb5\u843d\u56de\u7b54\u7684"']}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"3-\u5173\u952e\u914d\u7f6e\u53c2\u6570",children:"3. \u5173\u952e\u914d\u7f6e\u53c2\u6570"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{style:{textAlign:"left"},children:"\u7ec4\u4ef6"}),(0,r.jsx)(s.th,{style:{textAlign:"left"},children:"\u53c2\u6570\u9879"}),(0,r.jsx)(s.th,{style:{textAlign:"left"},children:"\u9ed8\u8ba4\u503c/\u8bf4\u660e"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.strong,{children:"Embedding"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"Model"}),(0,r.jsxs)(s.td,{style:{textAlign:"left"},children:[(0,r.jsx)(s.code,{children:"doubao-embedding-vision-251215"})," (\u901a\u8fc7 ARK API)"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.strong,{children:"Reranker"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"Model Type"}),(0,r.jsxs)(s.td,{style:{textAlign:"left"},children:[(0,r.jsx)(s.code,{children:"balanced"})," (ms-marco-MiniLM-L-6-v2)"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"}}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"Options"}),(0,r.jsxs)(s.td,{style:{textAlign:"left"},children:[(0,r.jsx)(s.code,{children:"fast"})," (L-2), ",(0,r.jsx)(s.code,{children:"quality"})," (L-12), ",(0,r.jsx)(s.code,{children:"multilingual"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.strong,{children:"Retrieval"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"vector_top_k"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"10 (\u5355\u8def\u53ec\u56de\u6570\u91cf)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"}}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"bm25_top_k"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"10 (\u5355\u8def\u53ec\u56de\u6570\u91cf)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"}}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"final_top_k"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"4 (\u6700\u7ec8\u7ed9 LLM \u7684\u6570\u91cf)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"}}),(0,r.jsxs)(s.td,{style:{textAlign:"left"},children:[(0,r.jsx)(s.code,{children:"k"})," (RRF)"]}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"60"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"4-\u4e3a\u4ec0\u4e48\u8fd9\u6837\u8bbe\u8ba1",children:"4. \u4e3a\u4ec0\u4e48\u8fd9\u6837\u8bbe\u8ba1\uff1f"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u89e3\u51b3 Embedding \u7f3a\u9677"}),': \u7eaf\u5411\u91cf\u68c0\u7d22\u5728\u5339\u914d"\u7cbe\u786e\u6307\u4ee4"\u6216"\u5982 CRM-001 \u8fd9\u6837\u7684\u4e13\u4e1a\u4ee3\u53f7"\u65f6\u6548\u679c\u6781\u5dee\uff0cBM25 \u5b8c\u7f8e\u4e92\u8865']}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u89e3\u51b3\u5206\u6570\u4e0d\u53ef\u6bd4"}),": RRF \u907f\u514d\u4e86\u8be5\u5982\u4f55\u52a0\u6743 Vector Score (0.85) \u548c BM25 Score (12.5) \u7684\u96be\u9898"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u63d0\u5347\u51c6\u786e\u7387"}),": Cross-Encoder \u867d\u7136\u6162\uff0c\u4f46\u53ea\u5bf9\u524d 10-20 \u4e2a\u7ed3\u679c\u8ba1\u7b97\uff0c\u8017\u65f6\u53ef\u63a7\uff08\u51e0\u5341\u6beb\u79d2\uff09\uff0c\u5374\u80fd\u5e26\u6765\u68c0\u7d22\u8d28\u91cf\u8d28\u7684\u98de\u8dc3\uff08Recall@K \u63d0\u5347\u663e\u8457\uff09"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"5-\u5173\u952e\u6587\u6863\u5904\u7406\u7b56\u7565\u5206\u8bcd\u4e0e\u5207\u5206",children:"5. \u5173\u952e\u6587\u6863\u5904\u7406\u7b56\u7565\uff1a\u5206\u8bcd\u4e0e\u5207\u5206"}),"\n",(0,r.jsxs)(s.p,{children:["\u5728 Embedding \u5316\u4e4b\u524d\uff0c\u6587\u6863\u5207\u5206\u662f\u51b3\u5b9a\u68c0\u7d22\u8d28\u91cf\u7684\u7b2c\u4e00\u9053\u95e8\u69db\u3002\u672c\u9879\u76ee\u91c7\u7528\u4e86 ",(0,r.jsx)(s.strong,{children:"Recursive Character Text Splitting (\u9012\u5f52\u5b57\u7b26\u5207\u5206)"})," \u7b56\u7565\u3002"]}),"\n",(0,r.jsxs)(s.h3,{id:"51-\u9012\u5f52\u5207\u5206\u903b\u8f91-recursivecharactertextsplitter",children:["5.1 \u9012\u5f52\u5207\u5206\u903b\u8f91 (",(0,r.jsx)(s.code,{children:"RecursiveCharacterTextSplitter"}),")"]}),"\n",(0,r.jsx)(s.p,{children:'\u4e0d\u540c\u4e8e\u7b80\u5355\u7684"\u6bcf 500 \u5b57\u4e00\u5200"\uff0c\u9012\u5f52\u5207\u5206\u4f1a\u5c1d\u8bd5\u6309\u7167\u8bed\u4e49\u5c42\u7ea7\u8fdb\u884c\u5206\u5272\uff0c\u4ee5\u4fdd\u6301\u53e5\u5b50\u7684\u5b8c\u6574\u6027\u3002'}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u4f18\u5148\u5206\u9694\u7b26\u5217\u8868"}),": ",(0,r.jsx)(s.code,{children:'["\\n\\n", "\\n", " ", ""]'})]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Level 1"}),": \u5148\u5c1d\u8bd5\u7528 ",(0,r.jsx)(s.code,{children:"\\n\\n"})," (\u6bb5\u843d) \u5207\u5206\u3002\u5982\u679c\u5207\u51fa\u6765\u7684\u4e00\u5757\u5c0f\u4e8e ",(0,r.jsx)(s.code,{children:"chunk_size"}),"\uff0c\u5c31\u4fdd\u7559"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Level 2"}),": \u5982\u679c\u67d0\u4e00\u6bb5\u592a\u957f\uff0c\u8d85\u8fc7\u4e86 ",(0,r.jsx)(s.code,{children:"chunk_size"}),"\uff0c\u5219\u5728\u8be5\u6bb5\u5185\u5c1d\u8bd5\u7528 ",(0,r.jsx)(s.code,{children:"\\n"})," (\u53e5\u5b50) \u518d\u6b21\u5207\u5206"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Level 3"}),": \u8fd8\u662f\u592a\u957f\uff0c\u5219\u7528\u7a7a\u683c\u5207\u5206"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Level 4"}),": \u6700\u540e\u624d\u5f3a\u5236\u6309\u5b57\u7b26\u622a\u65ad"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"52-\u53c2\u6570\u914d\u7f6e",children:"5.2 \u53c2\u6570\u914d\u7f6e"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Chunk Size (\u5757\u5927\u5c0f)"}),": \u9ed8\u8ba4\u4e3a ",(0,r.jsx)(s.code,{children:"1000"})," \u5b57\u7b26","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"\u8fd9\u4e2a\u5927\u5c0f\u901a\u5e38\u5305\u542b 2-3 \u4e2a\u5b8c\u6574\u6bb5\u843d\uff0c\u8db3\u591f LLM \u7406\u89e3\u4e0a\u4e0b\u6587\uff0c\u53c8\u4e0d\u4f1a\u56e0\u4e3a\u592a\u957f\u5bfc\u81f4\u68c0\u7d22\u566a\u97f3"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Chunk Overlap (\u5757\u91cd\u53e0)"}),": \u9ed8\u8ba4\u4e3a ",(0,r.jsx)(s.code,{children:"200"})," \u5b57\u7b26","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u4f5c\u7528"}),': \u9632\u6b62\u5173\u952e\u4fe1\u606f\u88ab\u5207\u65ad\u3002\u4f8b\u5982"\u9519\u8bef\u7801 502 \u7684\u89e3\u51b3\u65b9\u6848\u662f..."\u8fd9\u53e5\u8bdd\u5982\u679c\u6b63\u597d\u5728\u5207\u5206\u70b9\u4e0a\uff0c\u91cd\u53e0\u673a\u5236\u4fdd\u8bc1\u4e86\u8fd9\u53e5\u8bdd\u5b8c\u6574\u5730\u51fa\u73b0\u5728 Chunk A \u7684\u7ed3\u5c3e\u548c Chunk B \u7684\u5f00\u5934']}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"53-\u5143\u6570\u636e\u7ee7\u627f",children:"5.3 \u5143\u6570\u636e\u7ee7\u627f"}),"\n",(0,r.jsxs)(s.p,{children:["\u5207\u5206\u540e\u7684\u6bcf\u4e2a Chunk ",(0,r.jsx)(s.strong,{children:"\u5fc5\u987b"}),"\u7ee7\u627f\u539f\u59cb\u6587\u6863\u7684 Metadata\uff1a"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"title"}),': \u539f\u59cb\u6587\u6863\u6807\u9898\uff08\u5982 "Langfuse \u90e8\u7f72\u6307\u5357"\uff09']}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"source"}),": \u6765\u6e90 URL \u6216\u6587\u4ef6\u540d"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"chunk_index"}),": \u5b83\u662f\u7b2c\u51e0\u5757"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u4f5c\u7528"}),': \u5728\u68c0\u7d22\u65f6\uff0c\u5373\u4fbf Chunk \u5185\u5bb9\u53ea\u662f"\u70b9\u51fb\u786e\u8ba4\u6309\u94ae"\uff0cLLM \u4e5f\u80fd\u901a\u8fc7 ',(0,r.jsx)(s.code,{children:"title"}),' \u77e5\u9053\u8fd9\u662f"\u90e8\u7f72\u6307\u5357"\u91cc\u7684\u786e\u8ba4\u6309\u94ae\uff0c\u800c\u4e0d\u662f"\u5220\u9664\u8d26\u53f7"\u91cc\u7684']}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"6-\u751f\u4ea7\u73af\u5883\u5347\u7ea7\u6307\u5357elasticsearch-\u5b9e\u73b0-bm25",children:"6. \u751f\u4ea7\u73af\u5883\u5347\u7ea7\u6307\u5357\uff1aElasticSearch \u5b9e\u73b0 BM25"}),"\n",(0,r.jsx)(s.p,{children:"\u5728\u751f\u4ea7\u73af\u5883\uff08\u6570\u636e\u91cf > 100k \u6216\u5bf9\u4e2d\u6587\u5206\u8bcd\u6709\u6781\u9ad8\u8981\u6c42\uff09\uff0c\u5efa\u8bae\u5c06\u5185\u5b58\u7248 BM25 \u8fc1\u79fb\u81f3 ElasticSearch (ES)\u3002"}),"\n",(0,r.jsx)(s.h3,{id:"61-\u4e3a\u4ec0\u4e48\u9009-es",children:"6.1 \u4e3a\u4ec0\u4e48\u9009 ES\uff1f"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u6301\u4e45\u5316"}),": \u7d22\u5f15\u5b58\u5728\u78c1\u76d8\uff0c\u670d\u52a1\u91cd\u542f\u65e0\u9700\u91cd\u5efa\u7d22\u5f15"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u4e13\u4e1a\u5206\u8bcd"}),": \u652f\u6301 IK \u5206\u8bcd\u5668\uff0c\u6bd4\u7b80\u5355\u7684\u7a7a\u683c\u5206\u8bcd\u66f4\u61c2\u4e2d\u6587"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"62-\u5206\u8bcd\u5668\u9009\u62e9-analyzer",children:"6.2 \u5206\u8bcd\u5668\u9009\u62e9 (Analyzer)"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"ik_max_word"}),": \u4f1a\u5c06\u6587\u672c\u505a\u6700\u7ec6\u7c92\u5ea6\u7684\u62c6\u5206","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:'\u4f8b\uff1a"\u4e2d\u534e\u4eba\u6c11\u5171\u548c\u56fd" -> "\u4e2d\u534e\u4eba\u6c11\u5171\u548c\u56fd"\u3001"\u4e2d\u534e"\u3001"\u534e\u4eba"\u3001"\u4eba\u6c11\u5171\u548c\u56fd"\u3001"\u4eba\u6c11"\u3001"\u5171\u548c\u56fd"'}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u4f18\u52bf"}),": \u6700\u5927\u5316\u53ec\u56de\u7387 (Recall)\u3002\u53ea\u8981\u641c\u5176\u4e2d\u4efb\u4f55\u4e00\u4e2a\u8bcd\u90fd\u80fd\u627e\u5230"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"ik_smart"}),": \u505a\u6700\u7c97\u7c92\u5ea6\u7684\u62c6\u5206","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:'\u4f8b\uff1a"\u4e2d\u534e\u4eba\u6c11\u5171\u548c\u56fd" -> "\u4e2d\u534e\u4eba\u6c11\u5171\u548c\u56fd"'}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u4f18\u52bf"}),": \u8282\u7701\u5b58\u50a8\u7a7a\u95f4\uff0c\u641c\u7d22\u66f4\u7cbe\u51c6"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u63a8\u8350\u7b56\u7565"}),": ",(0,r.jsxs)(s.strong,{children:["\u7d22\u5f15\u65f6\u7528 ",(0,r.jsx)(s.code,{children:"ik_max_word"})]})," (\u4fdd\u8bc1\u80fd\u88ab\u641c\u5230)\uff0c",(0,r.jsxs)(s.strong,{children:["\u641c\u7d22\u65f6\u7528 ",(0,r.jsx)(s.code,{children:"ik_smart"})]})," (\u4fdd\u8bc1\u641c\u5f97\u51c6)"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"63-es-\u7d22\u5f15-mapping-\u793a\u4f8b",children:"6.3 ES \u7d22\u5f15 Mapping \u793a\u4f8b"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'PUT /rag_index\n{\n  "settings": {\n    "analysis": {\n      "analyzer": {\n        "my_analyzer": {\n          "tokenizer": "ik_max_word"\n        }\n      }\n    }\n  },\n  "mappings": {\n    "properties": {\n      "content": {\n        "type": "text",\n        "analyzer": "my_analyzer",\n        "search_analyzer": "ik_smart"\n      },\n      "embedding": {\n        "type": "dense_vector",\n        "dims": 1536\n      },\n      "metadata": { "type": "object" }\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"7-\u603b\u7ed3",children:"7. \u603b\u7ed3"}),"\n",(0,r.jsx)(s.p,{children:"\u5de5\u4e1a\u7ea7 RAG \u7cfb\u7edf\u7684\u6838\u5fc3\u8bbe\u8ba1\u7406\u5ff5\uff1a"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"\u591a\u8def\u53ec\u56de (\u9ad8\u53ec\u56de\u7387) \u2192 RRF \u878d\u5408 (\u516c\u5e73\u5408\u5e76) \u2192 Cross-Encoder \u91cd\u6392 (\u9ad8\u7cbe\u5ea6)\n"})}),"\n",(0,r.jsx)(s.p,{children:"\u8fd9\u5957\u67b6\u6784\u5728\u4fdd\u8bc1\u53ec\u56de\u7387\u7684\u540c\u65f6\uff0c\u901a\u8fc7\u91cd\u6392\u5e8f\u5927\u5e45\u63d0\u5347\u4e86\u6700\u7ec8\u7ed3\u679c\u7684\u76f8\u5173\u6027\uff0c\u662f\u5f53\u524d\u4e1a\u754c\u9a8c\u8bc1\u6709\u6548\u7684\u4e3b\u6d41\u65b9\u6848\u3002"})]})}function x(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);