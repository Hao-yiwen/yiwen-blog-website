# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## 项目概述

这是一个基于 Docusaurus 3.6.3 构建的技术博客网站，专注于软件开发和人工智能领域。主要使用中文，支持 i18n（中英文）。

**技术栈:** Docusaurus 3.6.3, React 18.2, TypeScript 5.1, KaTeX（数学公式）, Giscus（评论）

**系统要求:** Node.js >= 18.0

## 内容组织

所有侧边栏使用 `type: 'autogenerated'`，`docs/` 目录结构直接决定导航：

- `docs/ai/` - 人工智能（base, cnn, pytorch, huggingface, python 等）
- `docs/native/` - Native 开发（ios, android, flutter, harmony 等）
- `docs/web/` - Web 开发（React, Nextjs, Css, Js 等）
- `docs/backend/` - 服务端（java, mysql, redis）
- `docs/cs_base/` - 计算机基础（算法, 设计模式, 网络）
- `docs/whelk/` - 个人内容
- `blog/` - 博客文章

## 常用命令

```bash
# 开发
npm install          # 安装依赖
npm start           # 启动开发服务器 (localhost:3000)

# 构建和部署
npm run build       # 构建生产站点
npm run serve       # 本地预览构建
npm run deploy      # 部署到 GitHub Pages

# 代码质量
npm run typecheck   # TypeScript 类型检查
npm run lint:css    # CSS 检查
npm run clear       # 清除缓存
```

## 核心配置

### docusaurus.config.js
- Base URL: `/yiwen-blog-website/` (GitHub Pages)
- i18n: `zh` (默认), `en`
- 数学公式: remark-math + rehype-katex
- 搜索: `@easyops-cn/docusaurus-search-local`
- 侧边栏: 全局禁用折叠 (`sidebarCollapsed: false`)

### 代码质量工具
- **Prettier** - 格式化 (tabWidth: 4, singleQuote: true)
- **Stylelint** - CSS 检查
- **CommitLint** - Conventional commits

## Git 工作流

### Pre-commit Hooks (Husky)
- 自动运行 Prettier 格式化和 Stylelint 检查
- 强制 Conventional Commits 格式

### Conventional Commits 示例
```bash
feat: 添加新功能
fix: 修复问题
docs: 更新文档
style: 代码格式
refactor: 重构
chore: 构建/工具更新
```

### CI/CD
- **master 分支**: 自动部署到 GitHub Pages
- **v* 标签**: 触发 Docker 镜像构建并推送到阿里云

### 分支策略
- `master` - 生产分支
- `claude/*` - Claude Code 开发分支
- 功能分支使用描述性名称

## 开发指南

### 添加新文档
1. 在 `docs/` 对应目录创建 `.md` 文件
2. 添加 frontmatter:
   ```yaml
   ---
   title: 文档标题
   sidebar_position: 1
   tags: [tag1, tag2]
   ---
   ```
3. 文档会自动出现在侧边栏

### 添加博客
在 `blog/` 目录创建文件，添加 frontmatter:
```yaml
---
title: 文章标题
authors: [yiwen]
tags: [react, tutorial]
date: 2024-11-15
---
```

### 数学公式
```markdown
行内: $E = mc^2$

块级:
$$
f(x) = \int_{-\infty}^{\infty} e^{-x^2} dx
$$
```

### 代码高亮
支持语言: swift, java, bash, dart, go, sql, objectivec, cpp, ruby, kotlin

## 重要提示

1. **配置**: `docusaurus.config.js` 使用异步函数模式，添加插件时保持此模式
2. **内容**: 中文为主，添加新文档直接放在 `docs/` 对应目录即可自动生成导航
3. **部署**: Docker 目标平台 `linux/amd64`
4. **提交**: 必须符合 Conventional Commits 规范
5. **MDX**: 所有 markdown 文件支持 React 组件
6. **开发**: 添加或修改文档时，直接写入文件即可，无需运行构建命令验证

## 故障排查

```bash
# 构建失败
npm run clear
rm -rf node_modules package-lock.json
npm install

# 重建搜索索引
npm run build
```

## 资源链接

- [Docusaurus 文档](https://docusaurus.io/docs)
- [KaTeX 文档](https://katex.org/docs/supported.html)
- [Conventional Commits](https://www.conventionalcommits.org/)

## 联系方式

- GitHub: [@Hao-yiwen](https://github.com/Hao-yiwen)
- 网站: https://hao-yiwen.github.io/yiwen-blog-website/
